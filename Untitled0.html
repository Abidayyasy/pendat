
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FUZZY C MEANS &#8212; Pendat</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Untitled0';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Pendat - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Pendat - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Buku Penambangan Data
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Bab1.html">BAB 1 - DATA MINING</a></li>


<li class="toctree-l1"><a class="reference internal" href="Bab2.html">BAB 2 - DATA UNDERSTANDING</a></li>





<li class="toctree-l1"><a class="reference internal" href="Bab3.html">BAB 3 - DETEKSI OUTLIER</a></li>



<li class="toctree-l1"><a class="reference internal" href="Bab3-1.html">DETEKSI OUTLIER MENGGUNAKAN KNN</a></li>

<li class="toctree-l1"><a class="reference internal" href="Bab3-2.html">DETEKSI OUTLIER MENGGUNAKAN LOF</a></li>



<li class="toctree-l1"><a class="reference internal" href="Bab4.html">NAIF BAYES</a></li>






<li class="toctree-l1"><a class="reference internal" href="UTS.html">UTS</a></li>



<li class="toctree-l1"><a class="reference internal" href="Bab5.html">K-MEANS CLUSTERING</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FUntitled0.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Untitled0.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>FUZZY C MEANS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">FUZZY C MEANS</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pengertian-fuzzy-c-means">Pengertian Fuzzy C Means</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#konsep-kunci">Konsep Kunci</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cara-kerja">Cara Kerja</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-penting-fuzziness">Parameter Penting: Fuzziness</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-algoritma">Langkah Algoritma</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="fuzzy-c-means">
<h1>FUZZY C MEANS<a class="headerlink" href="#fuzzy-c-means" title="Link to this heading">#</a></h1>
</section>
<section id="pengertian-fuzzy-c-means">
<h1>Pengertian Fuzzy C Means<a class="headerlink" href="#pengertian-fuzzy-c-means" title="Link to this heading">#</a></h1>
<p>Fuzzy C-Means adalah sebuah algoritma clustering yang bertujuan mengelompokan titik-titik data berdasarkan kemiripannya. Bedanya dengan clustering biasa seperti K-means, FCM memungkinkan satu titik data untuk menjadi anggota beberapa kelompok sekaligus tapi dengan derajat keanggotaan yang berbeda-beda antara 0 sampai 1. Ini sangat berguna untuk data yang abu-abu atau punya karakteristika mirip dengan lebih dari satu kelompok</p>
</section>
<section id="konsep-kunci">
<h1>Konsep Kunci<a class="headerlink" href="#konsep-kunci" title="Link to this heading">#</a></h1>
<p>Ada dua elemen utama yang terus diperbarui dalam FCM:</p>
<ul class="simple">
<li><p>Centroid: ini adalah titik pusat atau wakil dari setiap kelomook. Letaknya bukan harus titik data sungguhan, tapi hasil rata-rata tertimbang dari semua data yang cenderung masuk ke kelompok tersebut</p></li>
<li><p>Matrik Keanggotaan: ini adalah tabel yang menunjukan seberapa mirip setiap titik data dengan setiap centroid. Setiap nilai dalam matriks ini adalah derajat keanggotaan antara 0 dan 1 dan total keanggotaan sebuah titik data ke semua kelompok selalu 1</p></li>
</ul>
</section>
<section id="cara-kerja">
<h1>Cara Kerja<a class="headerlink" href="#cara-kerja" title="Link to this heading">#</a></h1>
<p>FCM bekerja secara berulang hingga menemukan solusi yang stabil:</p>
<ol class="arabic simple">
<li><p>Insialisasi awal: algoritma memulai dengan matriks keanggotaan acak atau centroid awal</p></li>
<li><p>Perhitungan centroid: menggunakan matriks keanggotaan saat ini, centroid baru dihitung. Data dengan keanggotaan tinggi ke suatu kelompok akan lebih menarik centroid kelompok tersebut.</p></li>
<li><p>Pembaruan matriks keanggotaan: dengan centroid yang baru, setiap titik data sekarang menghitung ulang seberapa dekatnya ia dengan setiap centroid. Semakin dekat, semakin tinggi keanggotaanya ke kelompok tersebut</p></li>
<li><p>Konvergensi: langkah 2 dan 3 diulang terus sampai centroid tidak banyak bergeser lagi/perubhaan keanggotaanya sudah sangat kecil menandakan bahwa algoritma telah menemukan kelompok yang stabil</p></li>
</ol>
</section>
<section id="parameter-penting-fuzziness">
<h1>Parameter Penting: Fuzziness<a class="headerlink" href="#parameter-penting-fuzziness" title="Link to this heading">#</a></h1>
<p>Parameter m umumnya 2 adalah kunci dalam FCM, Ini mengontrol seberapa kabur/lunak batas antar kelompok</p>
<ul class="simple">
<li><p>m besar: batas kelompok menjadi lebih lunak dan keanggotaan titik data cenderung lebih merata di beberapa kelompok misalnya banyak nilai 0.5</p></li>
<li><p>m kecil (mendekati 1): batas kelompok menjadi lebih tegas dan keanggotaan akan cenderung mendekati 0/1, mirip dengan hard clustering</p></li>
</ul>
<p>FCM memberikan pemahaman yang lebih kaya tentang struktur data, karena tidak memaksa setiap data untuk hanya masuk ke satu kelompok saja</p>
</section>
<section id="langkah-algoritma">
<h1>Langkah Algoritma<a class="headerlink" href="#langkah-algoritma" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Inisialisasi jumlah cluster C, nilai m dan matriks keanggotaan U</p></li>
<li><p>Iterasi sampai konvergen:</p></li>
</ol>
<ul class="simple">
<li><p>hitung pusat cluster c</p></li>
<li><p>update matriks keanggotaan Uij</p></li>
<li><p>hitung fungsi objektif</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Update derajat keanggotaan</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Data 4 titik 2 dimensi</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>  <span class="c1"># x1</span>
    <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>  <span class="c1"># x2</span>
    <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>  <span class="c1"># x3</span>
    <span class="p">[</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">],</span>   <span class="c1"># x4</span>
    <span class="p">[</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">]</span>
<span class="p">])</span>

<span class="c1"># Matriks keanggotaan awal (u) untuk iterasi pertama</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="p">])</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># fuzziness</span>

<span class="k">def</span><span class="w"> </span><span class="nf">hitung_centroid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">c1_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">c1_den</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; Menghitung centroid cluster 1 (c1):&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="n">u_ij_m</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="n">m</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  u_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">1^</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> * x_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u_ij_m</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u_ij_m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">c1_num</span> <span class="o">+=</span> <span class="n">u_ij_m</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">c1_den</span> <span class="o">+=</span> <span class="n">u_ij_m</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">c1_num</span> <span class="o">/</span> <span class="n">c1_den</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Numerator c1 = </span><span class="si">{</span><span class="n">c1_num</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Denominator c1 = </span><span class="si">{</span><span class="n">c1_den</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Centroid c1 = </span><span class="si">{</span><span class="n">c1</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">c2_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">c2_den</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; Menghitung centroid cluster 2 (c2):&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="n">u_ij_m</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="n">m</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  u_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">2^</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> * x_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u_ij_m</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u_ij_m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">c2_num</span> <span class="o">+=</span> <span class="n">u_ij_m</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">c2_den</span> <span class="o">+=</span> <span class="n">u_ij_m</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">c2_num</span> <span class="o">/</span> <span class="n">c2_den</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Numerator c2 = </span><span class="si">{</span><span class="n">c2_num</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Denominator c2 = </span><span class="si">{</span><span class="n">c2_den</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Centroid c2 = </span><span class="si">{</span><span class="n">c2</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span>


<span class="c1"># =================== ITERASI 1 ====================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===== ITERASI 1 =====</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">centroids_iter1</span> <span class="o">=</span> <span class="n">hitung_centroid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">u_iter2</span> <span class="o">=</span> <span class="n">perbarui_keanggotaan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids_iter1</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

<span class="c1"># =================== ITERASI 2 ====================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===== ITERASI 2 =====</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">centroids_iter2</span> <span class="o">=</span> <span class="n">hitung_centroid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">u_iter2</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">u_iter3</span> <span class="o">=</span> <span class="n">perbarui_keanggotaan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids_iter2</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== ITERASI 1 =====

&gt;&gt;&gt; Menghitung centroid cluster 1 (c1):
  u_11^2 * x_1 = 0.5^2 * [1. 2.] = 0.25 * [1. 2.] = [0.25 0.5 ]
  u_21^2 * x_2 = 0.7^2 * [2. 3.] = 0.48999999999999994 * [2. 3.] = [0.98 1.47]
  u_31^2 * x_3 = 0.8^2 * [3. 4.] = 0.6400000000000001 * [3. 4.] = [1.92 2.56]
  u_41^2 * x_4 = 0.7^2 * [6. 7.] = 0.48999999999999994 * [6. 7.] = [2.94 3.43]
  u_51^2 * x_5 = 0.6^2 * [7. 8.] = 0.36 * [7. 8.] = [2.52 2.88]
  Numerator c1 = [ 8.61 10.84]
  Denominator c1 = 2.23
  Centroid c1 = [3.86098655 4.86098655]

&gt;&gt;&gt; Menghitung centroid cluster 2 (c2):
  u_12^2 * x_1 = 0.5^2 * [1. 2.] = 0.25 * [1. 2.] = [0.25 0.5 ]
  u_22^2 * x_2 = 0.3^2 * [2. 3.] = 0.09 * [2. 3.] = [0.18 0.27]
  u_32^2 * x_3 = 0.2^2 * [3. 4.] = 0.04000000000000001 * [3. 4.] = [0.12 0.16]
  u_42^2 * x_4 = 0.3^2 * [6. 7.] = 0.09 * [6. 7.] = [0.54 0.63]
  u_52^2 * x_5 = 0.4^2 * [7. 8.] = 0.16000000000000003 * [7. 8.] = [1.12 1.28]
  Numerator c2 = [2.21 2.84]
  Denominator c2 = 0.63
  Centroid c2 = [3.50793651 4.50793651]
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-1-b5a021dec7a1&gt;</span> in <span class="ni">&lt;cell line: 0&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===== ITERASI 1 =====</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="n">centroids_iter1</span> <span class="o">=</span> <span class="n">hitung_centroid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">56</span> <span class="n">u_iter2</span> <span class="o">=</span> <span class="n">perbarui_keanggotaan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids_iter1</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> 
<span class="g g-Whitespace">     </span><span class="mi">58</span> <span class="c1"># =================== ITERASI 2 ====================</span>

<span class="ne">NameError</span>: name &#39;perbarui_keanggotaan&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Data 5 titik 2 dimensi</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">]</span>
<span class="p">])</span>

<span class="c1"># Matriks keanggotaan awal (u)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="p">])</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># fuzziness</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-4</span>  <span class="c1"># toleransi konvergensi</span>

<span class="k">def</span><span class="w"> </span><span class="nf">hitung_centroid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">iter_ke</span><span class="p">):</span>
    <span class="n">c1_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">c1_den</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Menghitung centroid cluster 1 (c1):&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="n">u_ij_m</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="n">m</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  u_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">1^</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> * x_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u_ij_m</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u_ij_m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">c1_num</span> <span class="o">+=</span> <span class="n">u_ij_m</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">c1_den</span> <span class="o">+=</span> <span class="n">u_ij_m</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">c1_num</span> <span class="o">/</span> <span class="n">c1_den</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Centroid c1 = </span><span class="si">{</span><span class="n">c1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">c2_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">c2_den</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Menghitung centroid cluster 2 (c2):&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="n">u_ij_m</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="n">m</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  u_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">2^</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> * x_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u_ij_m</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u_ij_m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">c2_num</span> <span class="o">+=</span> <span class="n">u_ij_m</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">c2_den</span> <span class="o">+=</span> <span class="n">u_ij_m</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">c2_num</span> <span class="o">/</span> <span class="n">c2_den</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Centroid c2 = </span><span class="si">{</span><span class="n">c2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">perbarui_keanggotaan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">centroids</span>
    <span class="n">u_baru</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]):</span>
            <span class="n">dist_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">denom</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span>
                <span class="p">(</span><span class="n">dist_ij</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ck</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">ck</span> <span class="ow">in</span> <span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]</span>
            <span class="p">])</span>
            <span class="n">u_baru</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">denom</span>
    <span class="k">return</span> <span class="n">u_baru</span>

<span class="k">def</span><span class="w"> </span><span class="nf">jarak_centroid</span><span class="p">(</span><span class="n">c_old</span><span class="p">,</span> <span class="n">c_new</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">c_old</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c_new</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">c_old</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">c_new</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># ==================== PROSES ITERASI SAMPAI KONVERGEN ====================</span>
<span class="n">maks_iterasi</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">iterasi</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">================== ITERASI </span><span class="si">{</span><span class="n">iterasi</span><span class="si">}</span><span class="s2"> ==================&quot;</span><span class="p">)</span>
    <span class="n">centroids_baru</span> <span class="o">=</span> <span class="n">hitung_centroid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">iterasi</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">iterasi</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">jarak_centroid</span><span class="p">(</span><span class="n">centroids_lama</span><span class="p">,</span> <span class="n">centroids_baru</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; Perubahan centroid = </span><span class="si">{</span><span class="n">delta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; Konvergen! Iterasi dihentikan.&quot;</span><span class="p">)</span>
            <span class="k">break</span>
    <span class="n">centroids_lama</span> <span class="o">=</span> <span class="n">centroids_baru</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">perbarui_keanggotaan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids_baru</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">iterasi</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">iterasi</span> <span class="o">&gt;</span> <span class="n">maks_iterasi</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; Mencapai batas maksimum iterasi.&quot;</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>================== ITERASI 1 ==================
Menghitung centroid cluster 1 (c1):
  u_11^2 * x_1 = 0.5^2 * [1. 2.] = 0.25 * [1. 2.] = [0.25 0.5 ]
  u_21^2 * x_2 = 0.7^2 * [2. 3.] = 0.48999999999999994 * [2. 3.] = [0.98 1.47]
  u_31^2 * x_3 = 0.8^2 * [3. 4.] = 0.6400000000000001 * [3. 4.] = [1.92 2.56]
  u_41^2 * x_4 = 0.7^2 * [6. 7.] = 0.48999999999999994 * [6. 7.] = [2.94 3.43]
  u_51^2 * x_5 = 0.6^2 * [7. 8.] = 0.36 * [7. 8.] = [2.52 2.88]
  Centroid c1 = [3.86098655 4.86098655]
Menghitung centroid cluster 2 (c2):
  u_12^2 * x_1 = 0.5^2 * [1. 2.] = 0.25 * [1. 2.] = [0.25 0.5 ]
  u_22^2 * x_2 = 0.3^2 * [2. 3.] = 0.09 * [2. 3.] = [0.18 0.27]
  u_32^2 * x_3 = 0.2^2 * [3. 4.] = 0.04000000000000001 * [3. 4.] = [0.12 0.16]
  u_42^2 * x_4 = 0.3^2 * [6. 7.] = 0.09 * [6. 7.] = [0.54 0.63]
  u_52^2 * x_5 = 0.4^2 * [7. 8.] = 0.16000000000000003 * [7. 8.] = [1.12 1.28]
  Centroid c2 = [3.50793651 4.50793651]

================== ITERASI 2 ==================
Menghitung centroid cluster 1 (c1):
  u_11^2 * x_1 = 0.43452504790569296^2 * [1. 2.] = 0.18881201725744476 * [1. 2.] = [0.18881202 0.37762403]
  u_21^2 * x_2 = 0.39634228001963157^2 * [2. 3.] = 0.15708720293116005 * [2. 3.] = [0.31417441 0.47126161]
  u_31^2 * x_3 = 0.2581809119841344^2 * [3. 4.] = 0.06665738331295935 * [3. 4.] = [0.19997215 0.26662953]
  u_41^2 * x_4 = 0.5757944756920172^2 * [6. 7.] = 0.33153927823744506 * [6. 7.] = [1.98923567 2.32077495]
  u_51^2 * x_5 = 0.5530912378573711^2 * [7. 8.] = 0.3059099173945991 * [7. 8.] = [2.14136942 2.44727934]
  Centroid c1 = [4.60336854 5.60336854]
Menghitung centroid cluster 2 (c2):
  u_12^2 * x_1 = 0.565474952094307^2 * [1. 2.] = 0.31976192144605875 * [1. 2.] = [0.31976192 0.63952384]
  u_22^2 * x_2 = 0.6036577199803683^2 * [2. 3.] = 0.3644026428918968 * [2. 3.] = [0.72880529 1.09320793]
  u_32^2 * x_3 = 0.7418190880158656^2 * [3. 4.] = 0.5502955593446905 * [3. 4.] = [1.65088668 2.20118224]
  u_42^2 * x_4 = 0.4242055243079828^2 * [6. 7.] = 0.17995032685341059 * [6. 7.] = [1.07970196 1.25965229]
  u_52^2 * x_5 = 0.44690876214262887^2 * [7. 8.] = 0.19972744167985682 * [7. 8.] = [1.39809209 1.59781953]
  Centroid c2 = [3.20743845 4.20743845]

&gt;&gt;&gt; Perubahan centroid = 1.4748551149609304

================== ITERASI 3 ==================
Menghitung centroid cluster 1 (c1):
  u_11^2 * x_1 = 0.27287736126847506^2 * [1. 2.] = 0.07446205429284586 * [1. 2.] = [0.07446205 0.14892411]
  u_21^2 * x_2 = 0.17702860178674734^2 * [2. 3.] = 0.03133912585057076 * [2. 3.] = [0.06267825 0.09401738]
  u_31^2 * x_3 = 0.016462758492047085^2 * [3. 4.] = 0.0002710224171674684 * [3. 4.] = [0.00081307 0.00108409]
  u_41^2 * x_4 = 0.7999196283388016^2 * [6. 7.] = 0.6398714118016865 * [6. 7.] = [3.83922847 4.47909988]
  u_51^2 * x_5 = 0.7146252271282933^2 * [7. 8.] = 0.5106892152481649 * [7. 8.] = [3.57482451 4.08551372]
  Centroid c1 = [6.00971594 7.00971594]
Menghitung centroid cluster 2 (c2):
  u_12^2 * x_1 = 0.7271226387315249^2 * [1. 2.] = 0.5287073317558957 * [1. 2.] = [0.52870733 1.05741466]
  u_22^2 * x_2 = 0.8229713982132527^2 * [2. 3.] = 0.6772819222770762 * [2. 3.] = [1.35456384 2.03184577]
  u_32^2 * x_3 = 0.983537241507953^2 * [3. 4.] = 0.9673455054330734 * [3. 4.] = [2.90203652 3.86938202]
  u_42^2 * x_4 = 0.20008037166119844^2 * [6. 7.] = 0.0400321551240833 * [6. 7.] = [0.24019293 0.28022509]
  u_52^2 * x_5 = 0.2853747728717066^2 * [7. 8.] = 0.08143876099157812 * [7. 8.] = [0.57007133 0.65151009]
  Centroid c2 = [2.43836418 3.43836418]

&gt;&gt;&gt; Perubahan centroid = 3.0765108365380076

================== ITERASI 4 ==================
Menghitung centroid cluster 1 (c1):
  u_11^2 * x_1 = 0.07615697690870273^2 * [1. 2.] = 0.00579988513187268 * [1. 2.] = [0.00579989 0.01159977]
  u_21^2 * x_2 = 0.011810899008210383^2 * [2. 3.] = 0.00013949733538214503 * [2. 3.] = [0.00027899 0.00041849]
  u_31^2 * x_3 = 0.03365059658877236^2 * [3. 4.] = 0.0011323626507802982 * [3. 4.] = [0.00339709 0.00452945]
  u_41^2 * x_4 = 0.9999925583768012^2 * [6. 7.] = 0.9999851168089802 * [6. 7.] = [5.9999107  6.99989582]
  u_51^2 * x_5 = 0.9549931508409306^2 * [7. 8.] = 0.9120119181530885 * [7. 8.] = [6.38408343 7.29609535]
  Centroid c1 = [6.45806457 7.45806457]
Menghitung centroid cluster 2 (c2):
  u_12^2 * x_1 = 0.9238430230912973^2 * [1. 2.] = 0.8534859313144673 * [1. 2.] = [0.85348593 1.70697186]
  u_22^2 * x_2 = 0.9881891009917897^2 * [2. 3.] = 0.9765176993189615 * [2. 3.] = [1.9530354 2.9295531]
  u_32^2 * x_3 = 0.9663494034112277^2 * [3. 4.] = 0.9338311694732356 * [3. 4.] = [2.80149351 3.73532468]
  u_42^2 * x_4 = 7.441623198677501e-06^2 * [6. 7.] = 5.537775583109516e-11 * [6. 7.] = [3.32266535e-10 3.87644291e-10]
  u_52^2 * x_5 = 0.04500684915906937^2 * [7. 8.] = 0.002025616471227223 * [7. 8.] = [0.01417932 0.01620493]
  Centroid c2 = [2.03271073 3.03271073]

&gt;&gt;&gt; Perubahan centroid = 1.207741309712902

================== ITERASI 5 ==================
Menghitung centroid cluster 1 (c1):
  u_11^2 * x_1 = 0.03456242762862664^2 * [1. 2.] = 0.0011945614035840538 * [1. 2.] = [0.00119456 0.00238912]
  u_21^2 * x_2 = 5.3834967379004464e-05^2 * [2. 3.] = 2.898203712698475e-09 * [2. 3.] = [5.79640743e-09 8.69461114e-09]
  u_31^2 * x_3 = 0.0725654375246299^2 * [3. 4.] = 0.005265742723140966 * [3. 4.] = [0.01579723 0.02106297]
  u_41^2 * x_4 = 0.9868442897235687^2 * [6. 7.] = 0.9738616521600149 * [6. 7.] = [5.84316991 6.81703157]
  u_51^2 * x_5 = 0.9882370214273178^2 * [7. 8.] = 0.9766124105195371 * [7. 8.] = [6.83628687 7.81289928]
  Centroid c1 = [6.48792764 7.48792764]
Menghitung centroid cluster 2 (c2):
  u_12^2 * x_1 = 0.9654375723713734^2 * [1. 2.] = 0.9320697061463309 * [1. 2.] = [0.93206971 1.86413941]
  u_22^2 * x_2 = 0.9999461650326211^2 * [2. 3.] = 0.9998923329634459 * [2. 3.] = [1.99978467 2.999677  ]
  u_32^2 * x_3 = 0.92743456247537^2 * [3. 4.] = 0.860134867673881 * [3. 4.] = [2.5804046  3.44053947]
  u_42^2 * x_4 = 0.013155710276431275^2 * [6. 7.] = 0.00017307271287739944 * [6. 7.] = [0.00103844 0.00121151]
  u_52^2 * x_5 = 0.011762978572682188^2 * [7. 8.] = 0.0001383676649013803 * [7. 8.] = [0.00096857 0.00110694]
  Centroid c2 = [1.97473482 2.97473482]

&gt;&gt;&gt; Perubahan centroid = 0.1242230822805846

================== ITERASI 6 ==================
Menghitung centroid cluster 1 (c1):
  u_11^2 * x_1 = 0.03058209561777898^2 * [1. 2.] = 0.0009352645723749763 * [1. 2.] = [0.00093526 0.00187053]
  u_21^2 * x_2 = 3.1691256497908205e-05^2 * [2. 3.] = 1.004335738416209e-09 * [2. 3.] = [2.00867148e-09 3.01300722e-09]
  u_31^2 * x_3 = 0.07953272109112731^2 * [3. 4.] = 0.006325453724159048 * [3. 4.] = [0.01897636 0.02530181]
  u_41^2 * x_4 = 0.9855193847618392^2 * [6. 7.] = 0.971248457741354 * [6. 7.] = [5.82749075 6.7987392 ]
  u_51^2 * x_5 = 0.9897231871033341^2 * [7. 8.] = 0.9795519870899813 * [7. 8.] = [6.85686391 7.8364159 ]
  Centroid c1 = [6.48818664 7.48818664]
Menghitung centroid cluster 2 (c2):
  u_12^2 * x_1 = 0.969417904382221^2 * [1. 2.] = 0.939771073336817 * [1. 2.] = [0.93977107 1.87954215]
  u_22^2 * x_2 = 0.9999683087435022^2 * [2. 3.] = 0.9999366184913401 * [2. 3.] = [1.99987324 2.99980986]
  u_32^2 * x_3 = 0.9204672789088727^2 * [3. 4.] = 0.8472600115419044 * [3. 4.] = [2.54178003 3.38904005]
  u_42^2 * x_4 = 0.014480615238160934^2 * [6. 7.] = 0.00020968821767565864 * [6. 7.] = [0.00125813 0.00146782]
  u_52^2 * x_5 = 0.010276812896665951^2 * [7. 8.] = 0.00010561288331307963 * [7. 8.] = [0.00073929 0.0008449 ]
  Centroid c2 = [1.96729997 2.96729997]

&gt;&gt;&gt; Perubahan centroid = 0.010880747832185464

================== ITERASI 7 ==================
Menghitung centroid cluster 1 (c1):
  u_11^2 * x_1 = 0.030128586769173054^2 * [1. 2.] = 0.0009077317407075896 * [1. 2.] = [0.00090773 0.00181546]
  u_21^2 * x_2 = 5.308007103370974e-05^2 * [2. 3.] = 2.8174939409436714e-09 * [2. 3.] = [5.63498788e-09 8.45248182e-09]
  u_31^2 * x_3 = 0.08058607945747372^2 * [3. 4.] = 0.006494116202326267 * [3. 4.] = [0.01948235 0.02597646]
  u_41^2 * x_4 = 0.9855568598192361^2 * [6. 7.] = 0.9713223239367534 * [6. 7.] = [5.82793394 6.79925627]
  u_51^2 * x_5 = 0.9897634745738294^2 * [7. 8.] = 0.9796317356004595 * [7. 8.] = [6.85742215 7.83705388]
  Centroid c1 = [6.4879658 7.4879658]
Menghitung centroid cluster 2 (c2):
  u_12^2 * x_1 = 0.9698714132308269^2 * [1. 2.] = 0.9406505582023614 * [1. 2.] = [0.94065056 1.88130112]
  u_22^2 * x_2 = 0.9999469199289663^2 * [2. 3.] = 0.9998938426754266 * [2. 3.] = [1.99978769 2.99968153]
  u_32^2 * x_3 = 0.9194139205425264^2 * [3. 4.] = 0.8453219572873789 * [3. 4.] = [2.53596587 3.38128783]
  u_42^2 * x_4 = 0.0144431401807638^2 * [6. 7.] = 0.00020860429828119378 * [6. 7.] = [0.00125163 0.00146023]
  u_52^2 * x_5 = 0.010236525426170548^2 * [7. 8.] = 0.00010478645280063612 * [7. 8.] = [0.00073351 0.00083829]
  Centroid c2 = [1.96627272 2.96627272]

&gt;&gt;&gt; Perubahan centroid = 0.0017650484657669434

================== ITERASI 8 ==================
Menghitung centroid cluster 1 (c1):
  u_11^2 * x_1 = 0.03006889948489769^2 * [1. 2.] = 0.0009041387162328806 * [1. 2.] = [0.00090414 0.00180828]
  u_21^2 * x_2 = 5.6472746604926e-05^2 * [2. 3.] = 3.189171109104181e-09 * [2. 3.] = [6.37834222e-09 9.56751333e-09]
  u_31^2 * x_3 = 0.08074292787629575^2 * [3. 4.] = 0.006519420402036697 * [3. 4.] = [0.01955826 0.02607768]
  u_41^2 * x_4 = 0.9855769780629693^2 * [6. 7.] = 0.9713619796877346 * [6. 7.] = [5.82817188 6.79953386]
  u_51^2 * x_5 = 0.9897588678752433^2 * [7. 8.] = 0.9796226165376832 * [7. 8.] = [6.85735832 7.83698093]
  Centroid c1 = [6.48791854 7.48791854]
Menghitung centroid cluster 2 (c2):
  u_12^2 * x_1 = 0.9699311005151023^2 * [1. 2.] = 0.9407663397464375 * [1. 2.] = [0.94076634 1.88153268]
  u_22^2 * x_2 = 0.999943527253395^2 * [2. 3.] = 0.9998870576959611 * [2. 3.] = [1.99977412 2.99966117]
  u_32^2 * x_3 = 0.9192570721237042^2 * [3. 4.] = 0.8450335646494451 * [3. 4.] = [2.53510069 3.38013426]
  u_42^2 * x_4 = 0.014423021937030649^2 * [6. 7.] = 0.00020802356179606732 * [6. 7.] = [0.00124814 0.00145616]
  u_52^2 * x_5 = 0.010241132124756731^2 * [7. 8.] = 0.00010488078719672432 * [7. 8.] = [0.00073417 0.00083905]
  Centroid c2 = [1.96612481 2.96612481]

&gt;&gt;&gt; Perubahan centroid = 0.0002760262625945725

================== ITERASI 9 ==================
Menghitung centroid cluster 1 (c1):
  u_11^2 * x_1 = 0.030060473318068597^2 * [1. 2.] = 0.0009036320561063141 * [1. 2.] = [0.00090363 0.00180726]
  u_21^2 * x_2 = 5.6970341839498824e-05^2 * [2. 3.] = 3.2456198493093503e-09 * [2. 3.] = [6.49123970e-09 9.73685955e-09]
  u_31^2 * x_3 = 0.0807661821928288^2 * [3. 4.] = 0.006523176186005216 * [3. 4.] = [0.01956953 0.0260927 ]
  u_41^2 * x_4 = 0.9855807739465188^2 * [6. 7.] = 0.971369461973019 * [6. 7.] = [5.82821677 6.79958623]
  u_51^2 * x_5 = 0.9897575922749976^2 * [7. 8.] = 0.9796200914660004 * [7. 8.] = [6.85734064 7.83696073]
  Centroid c1 = [6.48791075 7.48791075]
Menghitung centroid cluster 2 (c2):
  u_12^2 * x_1 = 0.9699395266819314^2 * [1. 2.] = 0.9407826854199691 * [1. 2.] = [0.94078269 1.88156537]
  u_22^2 * x_2 = 0.9999430296581604^2 * [2. 3.] = 0.9998860625619407 * [2. 3.] = [1.99977213 2.99965819]
  u_32^2 * x_3 = 0.9192338178071713^2 * [3. 4.] = 0.8449908118003477 * [3. 4.] = [2.53497244 3.37996325]
  u_42^2 * x_4 = 0.014419226053481142^2 * [6. 7.] = 0.00020791407998138934 * [6. 7.] = [0.00124748 0.0014554 ]
  u_52^2 * x_5 = 0.010242407725002385^2 * [7. 8.] = 0.00010490691600518853 * [7. 8.] = [0.00073435 0.00083926]
  Centroid c2 = [1.96610315 2.96610315]

&gt;&gt;&gt; Perubahan centroid = 4.1650195254704396e-05

&gt;&gt;&gt; Konvergen! Iterasi dihentikan.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">perbarui_keanggotaan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">centroids</span>
    <span class="n">u_baru</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; Memperbarui matriks keanggotaan u:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]):</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">denom</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Untuk data x</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> dan cluster c</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Jarak numerator ||x</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - v</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">|| = </span><span class="si">{</span><span class="n">numerator</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">ck</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]):</span>
                <span class="n">jarak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ck</span><span class="p">)</span>
                <span class="n">rasio</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerator</span> <span class="o">/</span> <span class="n">jarak</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">denom</span> <span class="o">+=</span> <span class="n">rasio</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    (||x</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - v</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">|| / ||x</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - v</span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">||)^</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="s2"> = (</span><span class="si">{</span><span class="n">numerator</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">jarak</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">)^2 = </span><span class="si">{</span><span class="n">rasio</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">u_baru</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">denom</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    u_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = 1 / </span><span class="si">{</span><span class="n">denom</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">u_baru</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">u_baru</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===== ITERASI 1 =====</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">u_iter2</span> <span class="o">=</span> <span class="n">perbarui_keanggotaan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids_iter1</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===== ITERASI 2 =====</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">u_iter3</span> <span class="o">=</span> <span class="n">perbarui_keanggotaan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids_iter2</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== ITERASI 1 =====

&gt;&gt;&gt; Memperbarui matriks keanggotaan u:

  Untuk data x1 dan cluster c1:
    Jarak numerator ||x1 - v1|| = 4.046045976654863
    (||x1 - v1|| / ||x1 - v1||)^2 = (4.046046 / 4.046046)^2 = 1.000000
    (||x1 - v1|| / ||x1 - v2||)^2 = (4.046046 / 3.546758)^2 = 1.301363
    u_11 = 1 / 2.301363 = 0.434525

  Untuk data x1 dan cluster c2:
    Jarak numerator ||x1 - v2|| = 3.5467578230944294
    (||x1 - v2|| / ||x1 - v1||)^2 = (3.546758 / 4.046046)^2 = 0.768425
    (||x1 - v2|| / ||x1 - v2||)^2 = (3.546758 / 3.546758)^2 = 1.000000
    u_12 = 1 / 1.768425 = 0.565475

  Untuk data x2 dan cluster c1:
    Jarak numerator ||x2 - v1|| = 2.6318324142817686
    (||x2 - v1|| / ||x2 - v1||)^2 = (2.631832 / 2.631832)^2 = 1.000000
    (||x2 - v1|| / ||x2 - v2||)^2 = (2.631832 / 2.132544)^2 = 1.523072
    u_21 = 1 / 2.523072 = 0.396342

  Untuk data x2 dan cluster c2:
    Jarak numerator ||x2 - v2|| = 2.1325442607213345
    (||x2 - v2|| / ||x2 - v1||)^2 = (2.132544 / 2.631832)^2 = 0.656568
    (||x2 - v2|| / ||x2 - v2||)^2 = (2.132544 / 2.132544)^2 = 1.000000
    u_22 = 1 / 1.656568 = 0.603658

  Untuk data x3 dan cluster c1:
    Jarak numerator ||x3 - v1|| = 1.2176188519086735
    (||x3 - v1|| / ||x3 - v1||)^2 = (1.217619 / 1.217619)^2 = 1.000000
    (||x3 - v1|| / ||x3 - v2||)^2 = (1.217619 / 0.718331)^2 = 2.873253
    u_31 = 1 / 3.873253 = 0.258181

  Untuk data x3 dan cluster c2:
    Jarak numerator ||x3 - v2|| = 0.7183306983482394
    (||x3 - v2|| / ||x3 - v1||)^2 = (0.718331 / 1.217619)^2 = 0.348038
    (||x3 - v2|| / ||x3 - v2||)^2 = (0.718331 / 0.718331)^2 = 1.000000
    u_32 = 1 / 1.348038 = 0.741819

  Untuk data x4 dan cluster c1:
    Jarak numerator ||x4 - v1|| = 3.0250218352106115
    (||x4 - v1|| / ||x4 - v1||)^2 = (3.025022 / 3.025022)^2 = 1.000000
    (||x4 - v1|| / ||x4 - v2||)^2 = (3.025022 / 3.524310)^2 = 0.736731
    u_41 = 1 / 1.736731 = 0.575794

  Untuk data x4 dan cluster c2:
    Jarak numerator ||x4 - v2|| = 3.5243099887710456
    (||x4 - v2|| / ||x4 - v1||)^2 = (3.524310 / 3.025022)^2 = 1.357348
    (||x4 - v2|| / ||x4 - v2||)^2 = (3.524310 / 3.524310)^2 = 1.000000
    u_42 = 1 / 2.357348 = 0.424206

  Untuk data x5 dan cluster c1:
    Jarak numerator ||x5 - v1|| = 4.439235397583706
    (||x5 - v1|| / ||x5 - v1||)^2 = (4.439235 / 4.439235)^2 = 1.000000
    (||x5 - v1|| / ||x5 - v2||)^2 = (4.439235 / 4.938524)^2 = 0.808020
    u_51 = 1 / 1.808020 = 0.553091

  Untuk data x5 dan cluster c2:
    Jarak numerator ||x5 - v2|| = 4.938523551144141
    (||x5 - v2|| / ||x5 - v1||)^2 = (4.938524 / 4.439235)^2 = 1.237593
    (||x5 - v2|| / ||x5 - v2||)^2 = (4.938524 / 4.938524)^2 = 1.000000
    u_52 = 1 / 2.237593 = 0.446909

===== ITERASI 2 =====

&gt;&gt;&gt; Memperbarui matriks keanggotaan u:

  Untuk data x1 dan cluster c1:
    Jarak numerator ||x1 - v1|| = 5.095932661781215
    (||x1 - v1|| / ||x1 - v1||)^2 = (5.095933 / 5.095933)^2 = 1.000000
    (||x1 - v1|| / ||x1 - v2||)^2 = (5.095933 / 3.121789)^2 = 2.664650
    u_11 = 1 / 3.664650 = 0.272877

  Untuk data x1 dan cluster c2:
    Jarak numerator ||x1 - v2|| = 3.1217893932598515
    (||x1 - v2|| / ||x1 - v1||)^2 = (3.121789 / 5.095933)^2 = 0.375284
    (||x1 - v2|| / ||x1 - v2||)^2 = (3.121789 / 3.121789)^2 = 1.000000
    u_12 = 1 / 1.375284 = 0.727123

  Untuk data x2 dan cluster c1:
    Jarak numerator ||x2 - v1|| = 3.6817190994081206
    (||x2 - v1|| / ||x2 - v1||)^2 = (3.681719 / 3.681719)^2 = 1.000000
    (||x2 - v1|| / ||x2 - v2||)^2 = (3.681719 / 1.707576)^2 = 4.648805
    u_21 = 1 / 5.648805 = 0.177029

  Untuk data x2 dan cluster c2:
    Jarak numerator ||x2 - v2|| = 1.7075758308867561
    (||x2 - v2|| / ||x2 - v1||)^2 = (1.707576 / 3.681719)^2 = 0.215109
    (||x2 - v2|| / ||x2 - v2||)^2 = (1.707576 / 1.707576)^2 = 1.000000
    u_22 = 1 / 1.215109 = 0.822971

  Untuk data x3 dan cluster c1:
    Jarak numerator ||x3 - v1|| = 2.2675055370350257
    (||x3 - v1|| / ||x3 - v1||)^2 = (2.267506 / 2.267506)^2 = 1.000000
    (||x3 - v1|| / ||x3 - v2||)^2 = (2.267506 / 0.293362)^2 = 59.743162
    u_31 = 1 / 60.743162 = 0.016463

  Untuk data x3 dan cluster c2:
    Jarak numerator ||x3 - v2|| = 0.2933622685136611
    (||x3 - v2|| / ||x3 - v1||)^2 = (0.293362 / 2.267506)^2 = 0.016738
    (||x3 - v2|| / ||x3 - v2||)^2 = (0.293362 / 0.293362)^2 = 1.000000
    u_32 = 1 / 1.016738 = 0.983537

  Untuk data x4 dan cluster c1:
    Jarak numerator ||x4 - v1|| = 1.9751351500842595
    (||x4 - v1|| / ||x4 - v1||)^2 = (1.975135 / 1.975135)^2 = 1.000000
    (||x4 - v1|| / ||x4 - v2||)^2 = (1.975135 / 3.949278)^2 = 0.250126
    u_41 = 1 / 1.250126 = 0.799920

  Untuk data x4 dan cluster c2:
    Jarak numerator ||x4 - v2|| = 3.949278418605624
    (||x4 - v2|| / ||x4 - v1||)^2 = (3.949278 / 1.975135)^2 = 3.997992
    (||x4 - v2|| / ||x4 - v2||)^2 = (3.949278 / 3.949278)^2 = 1.000000
    u_42 = 1 / 4.997992 = 0.200080

  Untuk data x5 dan cluster c1:
    Jarak numerator ||x5 - v1|| = 3.389348712457355
    (||x5 - v1|| / ||x5 - v1||)^2 = (3.389349 / 3.389349)^2 = 1.000000
    (||x5 - v1|| / ||x5 - v2||)^2 = (3.389349 / 5.363492)^2 = 0.399335
    u_51 = 1 / 1.399335 = 0.714625

  Untuk data x5 dan cluster c2:
    Jarak numerator ||x5 - v2|| = 5.363491980978719
    (||x5 - v2|| / ||x5 - v1||)^2 = (5.363492 / 3.389349)^2 = 2.504164
    (||x5 - v2|| / ||x5 - v2||)^2 = (5.363492 / 5.363492)^2 = 1.000000
    u_52 = 1 / 3.504164 = 0.285375
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># --- 1. Data dan Parameter Awal ---</span>
<span class="c1"># Data 5 titik 2 dimensi (sesuai permintaan)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>  <span class="c1"># x1</span>
    <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>  <span class="c1"># x2</span>
    <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>  <span class="c1"># x3</span>
    <span class="p">[</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">],</span>  <span class="c1"># x4</span>
    <span class="p">[</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">]</span>   <span class="c1"># x5</span>
<span class="p">])</span>

<span class="c1"># Matriks keanggotaan awal (u) (sesuai permintaan)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="p">])</span>

<span class="c1"># Menentukan jumlah cluster (C) dari bentuk matriks keanggotaan awal</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Parameter fuzziness (m). Umumnya 2.</span>

<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-4</span>  <span class="c1"># Toleransi konvergensi (0.0001)</span>
<span class="n">maks_iterasi</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># Batas iterasi maksimum untuk mencegah infinite loop</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===== INISIALISASI =====&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data (X):</span><span class="se">\n</span><span class="si">{</span><span class="n">X</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah Cluster (C): </span><span class="si">{</span><span class="n">C</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter Fuzziness (m): </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Toleransi Konvergensi (epsilon): </span><span class="si">{</span><span class="n">epsilon</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriks Keanggotaan Awal (u):</span><span class="se">\n</span><span class="si">{</span><span class="n">u</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- 2. Fungsi-fungsi Inti FCM ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">hitung_centroid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Menghitung centroid (pusat cluster) berdasarkan matriks keanggotaan.</span>
<span class="sd">    Rumus: V_j = SUM(u_ij^m * x_i) / SUM(u_ij^m)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">num_dimensions</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">num_clusters</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">num_dimensions</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Menghitung Centroid ---&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters</span><span class="p">):</span> <span class="c1"># Loop untuk setiap cluster</span>
        <span class="n">c_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dimensions</span><span class="p">)</span>
        <span class="n">c_den</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">):</span> <span class="c1"># Loop untuk setiap titik data</span>
            <span class="n">u_ij_m</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">**</span> <span class="n">m</span> <span class="c1"># u_ij pangkat m</span>
            <span class="n">c_num</span> <span class="o">+=</span> <span class="n">u_ij_m</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># Pembilang</span>
            <span class="n">c_den</span> <span class="o">+=</span> <span class="n">u_ij_m</span>       <span class="c1"># Penyebut</span>

        <span class="c1"># Handle division by zero if a cluster has zero membership (unlikely with random init)</span>
        <span class="k">if</span> <span class="n">c_den</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Jika penyebut 0, artinya tidak ada titik data yang memiliki keanggotaan ke cluster ini.</span>
            <span class="c1"># Kita bisa menginisialisasi ulang centroid ini secara acak, atau membiarkannya 0.</span>
            <span class="c1"># Untuk kasus ini, kita biarkan 0 atau bisa juga assign ke titik data random</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dimensions</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_num</span> <span class="o">/</span> <span class="n">c_den</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Centroid c</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centroids</span>

<span class="k">def</span><span class="w"> </span><span class="nf">perbarui_keanggotaan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Memperbarui matriks keanggotaan berdasarkan centroid yang baru.</span>
<span class="sd">    Rumus: u_ij = 1 / SUM_k((||x_i - V_j|| / ||x_i - V_k||)^(2/(m-1)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">num_clusters</span> <span class="o">=</span> <span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">u_baru</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_data_points</span><span class="p">,</span> <span class="n">num_clusters</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Memperbarui Matriks Keanggotaan ---&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">):</span> <span class="c1"># Loop untuk setiap titik data</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters</span><span class="p">):</span> <span class="c1"># Loop untuk setiap cluster (untuk u_ij)</span>
            <span class="n">numerator_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="c1"># Jarak ||x_i - V_j||</span>

            <span class="n">denom_sum</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters</span><span class="p">):</span> <span class="c1"># Loop untuk setiap cluster (untuk bagian penyebut)</span>
                <span class="n">dist_to_ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="c1"># Jarak ||x_i - V_k||</span>

                <span class="c1"># Menangani kasus khusus: jarak nol</span>
                <span class="k">if</span> <span class="n">dist_to_ck</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Jika titik data persis berada di centroid &#39;k&#39;, maka keanggotaannya ke &#39;k&#39; adalah 1,</span>
                    <span class="c1"># dan ke cluster lain adalah 0. Ini adalah pengecualian pada rumus umum FCM.</span>
                    <span class="k">if</span> <span class="n">numerator_dist</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># Ini berarti j == k (titik data persis di centroid cluster j)</span>
                        <span class="n">u_baru</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                        <span class="n">denom_sum</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># Pastikan denominator tidak 0 agar tidak mempengaruhi hitungan ini</span>
                        <span class="k">break</span> <span class="c1"># Keluar dari loop k karena keanggotaan untuk x[i] sudah ditentukan</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Jika dist_to_ck == 0 tapi numerator_dist != 0, artinya x[i] sama persis</span>
                        <span class="c1"># dengan centroid k (cluster lain), sehingga u_ij ini harus 0.</span>
                        <span class="c1"># Untuk menghindari ZeroDivisionError, dist_to_ck diatur ke nilai sangat kecil.</span>
                        <span class="n">dist_to_ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>

                <span class="c1"># Hitung rasio pangkat (2/(m-1))</span>
                <span class="n">power_val</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerator_dist</span> <span class="o">/</span> <span class="n">dist_to_ck</span><span class="p">)</span> <span class="o">**</span> <span class="n">power_val</span>
                <span class="n">denom_sum</span> <span class="o">+=</span> <span class="n">ratio</span>

            <span class="c1"># Hitung u_ij</span>
            <span class="k">if</span> <span class="n">denom_sum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># Ini bisa terjadi jika semua dist_to_ck adalah 0 (semua centroid sama dengan X[i])</span>
                <span class="n">u_baru</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">num_clusters</span> <span class="c1"># Bagikan rata jika semua sama</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">u_baru</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">denom_sum</span>

    <span class="c1"># Pastikan total keanggotaan setiap baris adalah 1 karena potensi floating point error</span>
    <span class="n">u_baru_normalized</span> <span class="o">=</span> <span class="n">u_baru</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">u_baru</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">u_baru_normalized</span>

<span class="k">def</span><span class="w"> </span><span class="nf">hitung_konvergensi</span><span class="p">(</span><span class="n">centroids_lama</span><span class="p">,</span> <span class="n">centroids_baru</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Menghitung total perubahan (jarak) antara centroid lama dan centroid baru.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_delta</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1"># Asumsi centroids_lama dan centroids_baru memiliki bentuk yang sama (jumlah_cluster, jumlah_dimensi)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">centroids_lama</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">total_delta</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">centroids_lama</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids_baru</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">total_delta</span>

<span class="c1"># --- 3. Proses Iterasi Utama FCM ---</span>
<span class="n">iterasi</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">centroids_lama</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Untuk menyimpan centroid dari iterasi sebelumnya</span>
<span class="n">delta_konvergensi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="c1"># Inisialisasi delta dengan nilai besar agar loop mulai</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==================== MEMULAI ALGORITMA FUZZY C-MEANS ====================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">while</span> <span class="n">iterasi</span> <span class="o">&lt;=</span> <span class="n">maks_iterasi</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===== ITERASI </span><span class="si">{</span><span class="n">iterasi</span><span class="si">}</span><span class="s2"> =====</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># LANGKAH 1: Hitung Centroid Baru</span>
    <span class="c1"># &#39;u&#39; yang digunakan di sini adalah matriks keanggotaan dari akhir iterasi sebelumnya (atau &#39;u&#39; awal)</span>
    <span class="n">centroids_baru</span> <span class="o">=</span> <span class="n">hitung_centroid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

    <span class="c1"># LANGKAH 2: Cek Konvergensi (setelah iterasi pertama)</span>
    <span class="k">if</span> <span class="n">iterasi</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">delta_konvergensi</span> <span class="o">=</span> <span class="n">hitung_konvergensi</span><span class="p">(</span><span class="n">centroids_lama</span><span class="p">,</span> <span class="n">centroids_baru</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; Total perubahan centroid dari iterasi sebelumnya: </span><span class="si">{</span><span class="n">delta_konvergensi</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">delta_konvergensi</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; **KONVERGENSI TERCAPAI!** Perubahan centroid di bawah toleransi.&quot;</span><span class="p">)</span>
            <span class="k">break</span> <span class="c1"># Hentikan loop karena sudah konvergen</span>

    <span class="c1"># Simpan centroid yang baru dihitung untuk perbandingan di iterasi berikutnya</span>
    <span class="n">centroids_lama</span> <span class="o">=</span> <span class="n">centroids_baru</span>

    <span class="c1"># LANGKAH 3: Perbarui Matriks Keanggotaan</span>
    <span class="c1"># &#39;u&#39; diperbarui di sini, dan akan digunakan sebagai input untuk iterasi berikutnya</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">perbarui_keanggotaan</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids_baru</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matriks Keanggotaan (u) setelah Iterasi </span><span class="si">{</span><span class="n">iterasi</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">u</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">iterasi</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># --- Hasil Akhir ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">==================== HASIL AKHIR CLUSTERING FUZZY C-MEANS ====================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah Iterasi yang Berjalan: </span><span class="si">{</span><span class="n">iterasi</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Toleransi Konvergensi Epsilon: </span><span class="si">{</span><span class="n">epsilon</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Perubahan Centroid Terakhir: </span><span class="si">{</span><span class="n">delta_konvergensi</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Centroid Akhir:</span><span class="se">\n</span><span class="si">{</span><span class="n">centroids_baru</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matriks Keanggotaan Akhir (u):</span><span class="se">\n</span><span class="si">{</span><span class="n">u</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Untuk melihat penugasan cluster &quot;keras&quot; (opsional, sebagai interpretasi hasil fuzzy)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Penugasan Cluster (Hard Assignment - Jika Diperlukan) ---&quot;</span><span class="p">)</span>
<span class="c1"># Setiap titik data dimasukkan ke cluster dengan keanggotaan tertinggi</span>
<span class="n">cluster_assignment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">assignment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cluster_assignment</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data x</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">) paling condong ke Cluster </span><span class="si">{</span><span class="n">assignment</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== INISIALISASI =====
Data (X):
[[1. 2.]
 [2. 3.]
 [3. 4.]
 [6. 7.]
 [7. 8.]]
Jumlah Cluster (C): 2
Parameter Fuzziness (m): 2
Toleransi Konvergensi (epsilon): 0.0001
Matriks Keanggotaan Awal (u):
[[0.5 0.5]
 [0.7 0.3]
 [0.8 0.2]
 [0.7 0.3]
 [0.6 0.4]]

==================== MEMULAI ALGORITMA FUZZY C-MEANS ====================


===== ITERASI 1 =====

--- Menghitung Centroid ---
  Centroid c1 = [3.86098655 4.86098655]
  Centroid c2 = [3.50793651 4.50793651]
--- Memperbarui Matriks Keanggotaan ---

Matriks Keanggotaan (u) setelah Iterasi 1:
[[0.43452505 0.56547495]
 [0.39634228 0.60365772]
 [0.25818091 0.74181909]
 [0.57579448 0.42420552]
 [0.55309124 0.44690876]]


===== ITERASI 2 =====

--- Menghitung Centroid ---
  Centroid c1 = [4.60336854 5.60336854]
  Centroid c2 = [3.20743845 4.20743845]

&gt;&gt;&gt; Total perubahan centroid dari iterasi sebelumnya: 1.47485511
--- Memperbarui Matriks Keanggotaan ---

Matriks Keanggotaan (u) setelah Iterasi 2:
[[0.27287736 0.72712264]
 [0.1770286  0.8229714 ]
 [0.01646276 0.98353724]
 [0.79991963 0.20008037]
 [0.71462523 0.28537477]]


===== ITERASI 3 =====

--- Menghitung Centroid ---
  Centroid c1 = [6.00971594 7.00971594]
  Centroid c2 = [2.43836418 3.43836418]

&gt;&gt;&gt; Total perubahan centroid dari iterasi sebelumnya: 3.07651084
--- Memperbarui Matriks Keanggotaan ---

Matriks Keanggotaan (u) setelah Iterasi 3:
[[7.61569769e-02 9.23843023e-01]
 [1.18108990e-02 9.88189101e-01]
 [3.36505966e-02 9.66349403e-01]
 [9.99992558e-01 7.44162320e-06]
 [9.54993151e-01 4.50068492e-02]]


===== ITERASI 4 =====

--- Menghitung Centroid ---
  Centroid c1 = [6.45806457 7.45806457]
  Centroid c2 = [2.03271073 3.03271073]

&gt;&gt;&gt; Total perubahan centroid dari iterasi sebelumnya: 1.20774131
--- Memperbarui Matriks Keanggotaan ---

Matriks Keanggotaan (u) setelah Iterasi 4:
[[3.45624276e-02 9.65437572e-01]
 [5.38349674e-05 9.99946165e-01]
 [7.25654375e-02 9.27434562e-01]
 [9.86844290e-01 1.31557103e-02]
 [9.88237021e-01 1.17629786e-02]]


===== ITERASI 5 =====

--- Menghitung Centroid ---
  Centroid c1 = [6.48792764 7.48792764]
  Centroid c2 = [1.97473482 2.97473482]

&gt;&gt;&gt; Total perubahan centroid dari iterasi sebelumnya: 0.12422308
--- Memperbarui Matriks Keanggotaan ---

Matriks Keanggotaan (u) setelah Iterasi 5:
[[3.05820956e-02 9.69417904e-01]
 [3.16912565e-05 9.99968309e-01]
 [7.95327211e-02 9.20467279e-01]
 [9.85519385e-01 1.44806152e-02]
 [9.89723187e-01 1.02768129e-02]]


===== ITERASI 6 =====

--- Menghitung Centroid ---
  Centroid c1 = [6.48818664 7.48818664]
  Centroid c2 = [1.96729997 2.96729997]

&gt;&gt;&gt; Total perubahan centroid dari iterasi sebelumnya: 0.01088075
--- Memperbarui Matriks Keanggotaan ---

Matriks Keanggotaan (u) setelah Iterasi 6:
[[3.01285868e-02 9.69871413e-01]
 [5.30800710e-05 9.99946920e-01]
 [8.05860795e-02 9.19413921e-01]
 [9.85556860e-01 1.44431402e-02]
 [9.89763475e-01 1.02365254e-02]]


===== ITERASI 7 =====

--- Menghitung Centroid ---
  Centroid c1 = [6.4879658 7.4879658]
  Centroid c2 = [1.96627272 2.96627272]

&gt;&gt;&gt; Total perubahan centroid dari iterasi sebelumnya: 0.00176505
--- Memperbarui Matriks Keanggotaan ---

Matriks Keanggotaan (u) setelah Iterasi 7:
[[3.00688995e-02 9.69931101e-01]
 [5.64727466e-05 9.99943527e-01]
 [8.07429279e-02 9.19257072e-01]
 [9.85576978e-01 1.44230219e-02]
 [9.89758868e-01 1.02411321e-02]]


===== ITERASI 8 =====

--- Menghitung Centroid ---
  Centroid c1 = [6.48791854 7.48791854]
  Centroid c2 = [1.96612481 2.96612481]

&gt;&gt;&gt; Total perubahan centroid dari iterasi sebelumnya: 0.00027603
--- Memperbarui Matriks Keanggotaan ---

Matriks Keanggotaan (u) setelah Iterasi 8:
[[3.00604733e-02 9.69939527e-01]
 [5.69703418e-05 9.99943030e-01]
 [8.07661822e-02 9.19233818e-01]
 [9.85580774e-01 1.44192261e-02]
 [9.89757592e-01 1.02424077e-02]]


===== ITERASI 9 =====

--- Menghitung Centroid ---
  Centroid c1 = [6.48791075 7.48791075]
  Centroid c2 = [1.96610315 2.96610315]

&gt;&gt;&gt; Total perubahan centroid dari iterasi sebelumnya: 0.00004165

&gt;&gt;&gt; **KONVERGENSI TERCAPAI!** Perubahan centroid di bawah toleransi.

==================== HASIL AKHIR CLUSTERING FUZZY C-MEANS ====================
Jumlah Iterasi yang Berjalan: 8
Toleransi Konvergensi Epsilon: 0.0001
Perubahan Centroid Terakhir: 0.00004165

Centroid Akhir:
[[6.48791075 7.48791075]
 [1.96610315 2.96610315]]

Matriks Keanggotaan Akhir (u):
[[3.00604733e-02 9.69939527e-01]
 [5.69703418e-05 9.99943030e-01]
 [8.07661822e-02 9.19233818e-01]
 [9.85580774e-01 1.44192261e-02]
 [9.89757592e-01 1.02424077e-02]]

--- Penugasan Cluster (Hard Assignment - Jika Diperlukan) ---
Data x1 ([1. 2.]) paling condong ke Cluster 2
Data x2 ([2. 3.]) paling condong ke Cluster 2
Data x3 ([3. 4.]) paling condong ke Cluster 2
Data x4 ([6. 7.]) paling condong ke Cluster 1
Data x5 ([7. 8.]) paling condong ke Cluster 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pymysql
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>psycopg2-binary
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pandas
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>SQLAlchemy<span class="w"> </span>pymysql
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>scikit-learn
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>numpy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting pymysql
  Downloading PyMySQL-1.1.1-py3-none-any.whl.metadata (4.4 kB)
Downloading PyMySQL-1.1.1-py3-none-any.whl (44 kB)
?25l    <span class=" -Color -Color-Green">0.0/45.0 kB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
    <span class=" -Color -Color-Green">45.0/45.0 kB</span> <span class=" -Color -Color-Red">1.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hInstalling collected packages: pymysql
Successfully installed pymysql-1.1.1
Collecting psycopg2-binary
  Downloading psycopg2_binary-2.9.10-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.9 kB)
Downloading psycopg2_binary-2.9.10-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.0 MB)
    <span class=" -Color -Color-Green">3.0/3.0 MB</span> <span class=" -Color -Color-Red">23.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hInstalling collected packages: psycopg2-binary
Successfully installed psycopg2-binary-2.9.10
Requirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (2.2.2)
Requirement already satisfied: numpy&gt;=1.23.2 in /usr/local/lib/python3.11/dist-packages (from pandas) (2.0.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas) (2025.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.17.0)
Requirement already satisfied: SQLAlchemy in /usr/local/lib/python3.11/dist-packages (2.0.41)
Requirement already satisfied: pymysql in /usr/local/lib/python3.11/dist-packages (1.1.1)
Requirement already satisfied: greenlet&gt;=1 in /usr/local/lib/python3.11/dist-packages (from SQLAlchemy) (3.2.2)
Requirement already satisfied: typing-extensions&gt;=4.6.0 in /usr/local/lib/python3.11/dist-packages (from SQLAlchemy) (4.13.2)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.11/dist-packages (1.6.1)
Requirement already satisfied: numpy&gt;=1.19.5 in /usr/local/lib/python3.11/dist-packages (from scikit-learn) (2.0.2)
Requirement already satisfied: scipy&gt;=1.6.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn) (1.15.3)
Requirement already satisfied: joblib&gt;=1.2.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn) (1.5.0)
Requirement already satisfied: threadpoolctl&gt;=3.1.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn) (3.6.0)
Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (2.0.2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymysql</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tabulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">tabulate</span>

<span class="n">MYSQL_HOST</span> <span class="o">=</span> <span class="s2">&quot;mysql-ce646e0-matakuliah.i.aivencloud.com&quot;</span>
<span class="n">MYSQL_PORT</span> <span class="o">=</span> <span class="mi">18376</span>
<span class="n">MYSQL_DB</span> <span class="o">=</span> <span class="s2">&quot;defaultdb&quot;</span>
<span class="n">MYSQL_USER</span> <span class="o">=</span> <span class="s2">&quot;avnadmin&quot;</span>
<span class="n">MYSQL_PASS</span> <span class="o">=</span> <span class="s2">&quot;AVNS_ttJDVCcji3xAatQ6zvd&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Membuat koneksi ke MySQL</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="n">host</span><span class="o">=</span><span class="n">MYSQL_HOST</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="n">MYSQL_PORT</span><span class="p">,</span>
        <span class="n">user</span><span class="o">=</span><span class="n">MYSQL_USER</span><span class="p">,</span>
        <span class="n">password</span><span class="o">=</span><span class="n">MYSQL_PASS</span><span class="p">,</span>
        <span class="n">database</span><span class="o">=</span><span class="n">MYSQL_DB</span><span class="p">,</span>
        <span class="n">ssl</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ssl&#39;</span><span class="p">:</span> <span class="p">{}},</span>  <span class="c1"># Aiven.io membutuhkan koneksi SSL</span>
    <span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="c1"># Menjalankan query (Ganti &#39;your_table&#39; dengan nama tabel yang benar)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM defaultdb.irissql;&quot;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="c1"># Mengambil nama kolom</span>
    <span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>

    <span class="c1"># Menampilkan hasil dalam bentuk tabel</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">))</span>

<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

<span class="k">finally</span><span class="p">:</span>
    <span class="c1"># Menutup koneksi</span>
    <span class="k">if</span> <span class="n">cur</span><span class="p">:</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">conn</span><span class="p">:</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+------+-----------------+----------------+-----------------+----------------+-----------------+
|     |   id |   SepalLengthCm |   SepalWidthCm |   PetalLengthCm |   PetalWidthCm | species         |
|-----+------+-----------------+----------------+-----------------+----------------+-----------------|
|   0 |    1 |             5.1 |            3.5 |             1.4 |            0.2 | Iris-setosa     |
|   1 |    2 |             4.9 |            3   |             1.4 |            0.2 | Iris-setosa     |
|   2 |    3 |             4.7 |            3.2 |             1.3 |            0.2 | Iris-setosa     |
|   3 |    4 |             4.6 |            3.1 |             1.5 |            0.2 | Iris-setosa     |
|   4 |    5 |             5   |            3.6 |             1.4 |            0.2 | Iris-setosa     |
|   5 |    6 |             5.4 |            3.9 |             1.7 |            0.4 | Iris-setosa     |
|   6 |    7 |             4.6 |            3.4 |             1.4 |            0.3 | Iris-setosa     |
|   7 |    8 |             5   |            3.4 |             1.5 |            0.2 | Iris-setosa     |
|   8 |    9 |             4.4 |            2.9 |             1.4 |            0.2 | Iris-setosa     |
|   9 |   10 |             4.9 |            3.1 |             1.5 |            0.1 | Iris-setosa     |
|  10 |   11 |             5.4 |            3.7 |             1.5 |            0.2 | Iris-setosa     |
|  11 |   12 |             4.8 |            3.4 |             1.6 |            0.2 | Iris-setosa     |
|  12 |   13 |             4.8 |            3   |             1.4 |            0.1 | Iris-setosa     |
|  13 |   14 |             4.3 |            3   |             1.1 |            0.1 | Iris-setosa     |
|  14 |   15 |             5.8 |            4   |             1.2 |            0.2 | Iris-setosa     |
|  15 |   16 |             5.7 |            4.4 |             1.5 |            0.4 | Iris-setosa     |
|  16 |   17 |             5.4 |            3.9 |             1.3 |            0.4 | Iris-setosa     |
|  17 |   18 |             5.1 |            3.5 |             1.4 |            0.3 | Iris-setosa     |
|  18 |   19 |             5.7 |            3.8 |             1.7 |            0.3 | Iris-setosa     |
|  19 |   20 |             5.1 |            3.8 |             1.5 |            0.3 | Iris-setosa     |
|  20 |   21 |             5.4 |            3.4 |             1.7 |            0.2 | Iris-setosa     |
|  21 |   22 |             5.1 |            3.7 |             1.5 |            0.4 | Iris-setosa     |
|  22 |   23 |             4.6 |            3.6 |             1   |            0.2 | Iris-setosa     |
|  23 |   24 |             5.1 |            3.3 |             1.7 |            0.5 | Iris-setosa     |
|  24 |   25 |             4.8 |            3.4 |             1.9 |            0.2 | Iris-setosa     |
|  25 |   26 |             5   |            3   |             1.6 |            0.2 | Iris-setosa     |
|  26 |   27 |             5   |            3.4 |             1.6 |            0.4 | Iris-setosa     |
|  27 |   28 |             5.2 |            3.5 |             1.5 |            0.2 | Iris-setosa     |
|  28 |   29 |             5.2 |            3.4 |             1.4 |            0.2 | Iris-setosa     |
|  29 |   30 |             4.7 |            3.2 |             1.6 |            0.2 | Iris-setosa     |
|  30 |   31 |             4.8 |            3.1 |             1.6 |            0.2 | Iris-setosa     |
|  31 |   32 |             5.4 |            3.4 |             1.5 |            0.4 | Iris-setosa     |
|  32 |   33 |             5.2 |            4.1 |             1.5 |            0.1 | Iris-setosa     |
|  33 |   34 |             5.5 |            4.2 |             1.4 |            0.2 | Iris-setosa     |
|  34 |   35 |             4.9 |            3.1 |             1.5 |            0.1 | Iris-setosa     |
|  35 |   36 |             5   |            3.2 |             1.2 |            0.2 | Iris-setosa     |
|  36 |   37 |             5.5 |            3.5 |             1.3 |            0.2 | Iris-setosa     |
|  37 |   38 |             4.9 |            3.1 |             1.5 |            0.1 | Iris-setosa     |
|  38 |   39 |             4.4 |            3   |             1.3 |            0.2 | Iris-setosa     |
|  39 |   40 |             5.1 |            3.4 |             1.5 |            0.2 | Iris-setosa     |
|  40 |   41 |             5   |            3.5 |             1.3 |            0.3 | Iris-setosa     |
|  41 |   42 |             4.5 |            2.3 |             1.3 |            0.3 | Iris-setosa     |
|  42 |   43 |             4.4 |            3.2 |             1.3 |            0.2 | Iris-setosa     |
|  43 |   44 |             5   |            3.5 |             1.6 |            0.6 | Iris-setosa     |
|  44 |   45 |             5.1 |            3.8 |             1.9 |            0.4 | Iris-setosa     |
|  45 |   46 |             4.8 |            3   |             1.4 |            0.3 | Iris-setosa     |
|  46 |   47 |             5.1 |            3.8 |             1.6 |            0.2 | Iris-setosa     |
|  47 |   48 |             4.6 |            3.2 |             1.4 |            0.2 | Iris-setosa     |
|  48 |   49 |             5.3 |            3.7 |             1.5 |            0.2 | Iris-setosa     |
|  49 |   50 |             5   |            3.3 |             1.4 |            0.2 | Iris-setosa     |
|  50 |   51 |             7   |            3.2 |             4.7 |            1.4 | Iris-versicolor |
|  51 |   52 |             6.4 |            3.2 |             4.5 |            1.5 | Iris-versicolor |
|  52 |   53 |             6.9 |            3.1 |             4.9 |            1.5 | Iris-versicolor |
|  53 |   54 |             5.5 |            2.3 |             4   |            1.3 | Iris-versicolor |
|  54 |   55 |             6.5 |            2.8 |             4.6 |            1.5 | Iris-versicolor |
|  55 |   56 |             5.7 |            2.8 |             4.5 |            1.3 | Iris-versicolor |
|  56 |   57 |             6.3 |            3.3 |             4.7 |            1.6 | Iris-versicolor |
|  57 |   58 |             4.9 |            2.4 |             3.3 |            1   | Iris-versicolor |
|  58 |   59 |             6.6 |            2.9 |             4.6 |            1.3 | Iris-versicolor |
|  59 |   60 |             5.2 |            2.7 |             3.9 |            1.4 | Iris-versicolor |
|  60 |   61 |             5   |            2   |             3.5 |            1   | Iris-versicolor |
|  61 |   62 |             5.9 |            3   |             4.2 |            1.5 | Iris-versicolor |
|  62 |   63 |             6   |            2.2 |             4   |            1   | Iris-versicolor |
|  63 |   64 |             6.1 |            2.9 |             4.7 |            1.4 | Iris-versicolor |
|  64 |   65 |             5.6 |            2.9 |             3.6 |            1.3 | Iris-versicolor |
|  65 |   66 |             6.7 |            3.1 |             4.4 |            1.4 | Iris-versicolor |
|  66 |   67 |             5.6 |            3   |             4.5 |            1.5 | Iris-versicolor |
|  67 |   68 |             5.8 |            2.7 |             4.1 |            1   | Iris-versicolor |
|  68 |   69 |             6.2 |            2.2 |             4.5 |            1.5 | Iris-versicolor |
|  69 |   70 |             5.6 |            2.5 |             3.9 |            1.1 | Iris-versicolor |
|  70 |   71 |             5.9 |            3.2 |             4.8 |            1.8 | Iris-versicolor |
|  71 |   72 |             6.1 |            2.8 |             4   |            1.3 | Iris-versicolor |
|  72 |   73 |             6.3 |            2.5 |             4.9 |            1.5 | Iris-versicolor |
|  73 |   74 |             6.1 |            2.8 |             4.7 |            1.2 | Iris-versicolor |
|  74 |   75 |             6.4 |            2.9 |             4.3 |            1.3 | Iris-versicolor |
|  75 |   76 |             6.6 |            3   |             4.4 |            1.4 | Iris-versicolor |
|  76 |   77 |             6.8 |            2.8 |             4.8 |            1.4 | Iris-versicolor |
|  77 |   78 |             6.7 |            3   |             5   |            1.7 | Iris-versicolor |
|  78 |   79 |             6   |            2.9 |             4.5 |            1.5 | Iris-versicolor |
|  79 |   80 |             5.7 |            2.6 |             3.5 |            1   | Iris-versicolor |
|  80 |   81 |             5.5 |            2.4 |             3.8 |            1.1 | Iris-versicolor |
|  81 |   82 |             5.5 |            2.4 |             3.7 |            1   | Iris-versicolor |
|  82 |   83 |             5.8 |            2.7 |             3.9 |            1.2 | Iris-versicolor |
|  83 |   84 |             6   |            2.7 |             5.1 |            1.6 | Iris-versicolor |
|  84 |   85 |             5.4 |            3   |             4.5 |            1.5 | Iris-versicolor |
|  85 |   86 |             6   |            3.4 |             4.5 |            1.6 | Iris-versicolor |
|  86 |   87 |             6.7 |            3.1 |             4.7 |            1.5 | Iris-versicolor |
|  87 |   88 |             6.3 |            2.3 |             4.4 |            1.3 | Iris-versicolor |
|  88 |   89 |             5.6 |            3   |             4.1 |            1.3 | Iris-versicolor |
|  89 |   90 |             5.5 |            2.5 |             4   |            1.3 | Iris-versicolor |
|  90 |   91 |             5.5 |            2.6 |             4.4 |            1.2 | Iris-versicolor |
|  91 |   92 |             6.1 |            3   |             4.6 |            1.4 | Iris-versicolor |
|  92 |   93 |             5.8 |            2.6 |             4   |            1.2 | Iris-versicolor |
|  93 |   94 |             5   |            2.3 |             3.3 |            1   | Iris-versicolor |
|  94 |   95 |             5.6 |            2.7 |             4.2 |            1.3 | Iris-versicolor |
|  95 |   96 |             5.7 |            3   |             4.2 |            1.2 | Iris-versicolor |
|  96 |   97 |             5.7 |            2.9 |             4.2 |            1.3 | Iris-versicolor |
|  97 |   98 |             6.2 |            2.9 |             4.3 |            1.3 | Iris-versicolor |
|  98 |   99 |             5.1 |            2.5 |             3   |            1.1 | Iris-versicolor |
|  99 |  100 |             5.7 |            2.8 |             4.1 |            1.3 | Iris-versicolor |
| 100 |  101 |             6.3 |            3.3 |             6   |            2.5 | Iris-virginica  |
| 101 |  102 |             5.8 |            2.7 |             5.1 |            1.9 | Iris-virginica  |
| 102 |  103 |             7.1 |            3   |             5.9 |            2.1 | Iris-virginica  |
| 103 |  104 |             6.3 |            2.9 |             5.6 |            1.8 | Iris-virginica  |
| 104 |  105 |             6.5 |            3   |             5.8 |            2.2 | Iris-virginica  |
| 105 |  106 |             7.6 |            3   |             6.6 |            2.1 | Iris-virginica  |
| 106 |  107 |             4.9 |            2.5 |             4.5 |            1.7 | Iris-virginica  |
| 107 |  108 |             7.3 |            2.9 |             6.3 |            1.8 | Iris-virginica  |
| 108 |  109 |             6.7 |            2.5 |             5.8 |            1.8 | Iris-virginica  |
| 109 |  110 |             7.2 |            3.6 |             6.1 |            2.5 | Iris-virginica  |
| 110 |  111 |             6.5 |            3.2 |             5.1 |            2   | Iris-virginica  |
| 111 |  112 |             6.4 |            2.7 |             5.3 |            1.9 | Iris-virginica  |
| 112 |  113 |             6.8 |            3   |             5.5 |            2.1 | Iris-virginica  |
| 113 |  114 |             5.7 |            2.5 |             5   |            2   | Iris-virginica  |
| 114 |  115 |             5.8 |            2.8 |             5.1 |            2.4 | Iris-virginica  |
| 115 |  116 |             6.4 |            3.2 |             5.3 |            2.3 | Iris-virginica  |
| 116 |  117 |             6.5 |            3   |             5.5 |            1.8 | Iris-virginica  |
| 117 |  118 |             7.7 |            3.8 |             6.7 |            2.2 | Iris-virginica  |
| 118 |  119 |             7.7 |            2.6 |             6.9 |            2.3 | Iris-virginica  |
| 119 |  120 |             6   |            2.2 |             5   |            1.5 | Iris-virginica  |
| 120 |  121 |             6.9 |            3.2 |             5.7 |            2.3 | Iris-virginica  |
| 121 |  122 |             5.6 |            2.8 |             4.9 |            2   | Iris-virginica  |
| 122 |  123 |             7.7 |            2.8 |             6.7 |            2   | Iris-virginica  |
| 123 |  124 |             6.3 |            2.7 |             4.9 |            1.8 | Iris-virginica  |
| 124 |  125 |             6.7 |            3.3 |             5.7 |            2.1 | Iris-virginica  |
| 125 |  126 |             7.2 |            3.2 |             6   |            1.8 | Iris-virginica  |
| 126 |  127 |             6.2 |            2.8 |             4.8 |            1.8 | Iris-virginica  |
| 127 |  128 |             6.1 |            3   |             4.9 |            1.8 | Iris-virginica  |
| 128 |  129 |             6.4 |            2.8 |             5.6 |            2.1 | Iris-virginica  |
| 129 |  130 |             7.2 |            3   |             5.8 |            1.6 | Iris-virginica  |
| 130 |  131 |             7.4 |            2.8 |             6.1 |            1.9 | Iris-virginica  |
| 131 |  132 |             7.9 |            3.8 |             6.4 |            2   | Iris-virginica  |
| 132 |  133 |             6.4 |            2.8 |             5.6 |            2.2 | Iris-virginica  |
| 133 |  134 |             6.3 |            2.8 |             5.1 |            1.5 | Iris-virginica  |
| 134 |  135 |             6.1 |            2.6 |             5.6 |            1.4 | Iris-virginica  |
| 135 |  136 |             7.7 |            3   |             6.1 |            2.3 | Iris-virginica  |
| 136 |  137 |             6.3 |            3.4 |             5.6 |            2.4 | Iris-virginica  |
| 137 |  138 |             6.4 |            3.1 |             5.5 |            1.8 | Iris-virginica  |
| 138 |  139 |             6   |            3   |             4.8 |            1.8 | Iris-virginica  |
| 139 |  140 |             6.9 |            3.1 |             5.4 |            2.1 | Iris-virginica  |
| 140 |  141 |             6.7 |            3.1 |             5.6 |            2.4 | Iris-virginica  |
| 141 |  142 |             6.9 |            3.1 |             5.1 |            2.3 | Iris-virginica  |
| 142 |  143 |             5.8 |            2.7 |             5.1 |            1.9 | Iris-virginica  |
| 143 |  144 |             6.8 |            3.2 |             5.9 |            2.3 | Iris-virginica  |
| 144 |  145 |             6.7 |            3.3 |             5.7 |            2.5 | Iris-virginica  |
| 145 |  146 |             6.7 |            3   |             5.2 |            2.3 | Iris-virginica  |
| 146 |  147 |             6.3 |            2.5 |             5   |            1.9 | Iris-virginica  |
| 147 |  148 |             6.5 |            3   |             5.2 |            2   | Iris-virginica  |
| 148 |  149 |             6.2 |            3.4 |             5.4 |            2.3 | Iris-virginica  |
| 149 |  150 |             5.9 |            3   |             5.1 |            1.8 | Iris-virginica  |
+-----+------+-----------------+----------------+-----------------+----------------+-----------------+
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymysql</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tabulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">tabulate</span>

<span class="n">MYSQL_HOST</span> <span class="o">=</span> <span class="s2">&quot;mysql-ce646e0-matakuliah.i.aivencloud.com&quot;</span>
<span class="n">MYSQL_PORT</span> <span class="o">=</span> <span class="mi">18376</span>  <span class="c1"># Aiven MySQL biasanya menggunakan port 25060</span>
<span class="n">MYSQL_DB</span> <span class="o">=</span> <span class="s2">&quot;defaultdb&quot;</span>  <span class="c1"># Ganti dengan nama database Anda</span>
<span class="n">MYSQL_USER</span> <span class="o">=</span> <span class="s2">&quot;avnadmin&quot;</span>  <span class="c1"># Username dari Aiven.io</span>
<span class="n">MYSQL_PASS</span> <span class="o">=</span> <span class="s2">&quot;AVNS_ttJDVCcji3xAatQ6zvd&quot;</span>  <span class="c1"># Ganti dengan password dari Aiven.io</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Membuat koneksi ke MySQL</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="n">host</span><span class="o">=</span><span class="n">MYSQL_HOST</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="n">MYSQL_PORT</span><span class="p">,</span>
        <span class="n">user</span><span class="o">=</span><span class="n">MYSQL_USER</span><span class="p">,</span>
        <span class="n">password</span><span class="o">=</span><span class="n">MYSQL_PASS</span><span class="p">,</span>
        <span class="n">database</span><span class="o">=</span><span class="n">MYSQL_DB</span><span class="p">,</span>
        <span class="n">ssl</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ssl&#39;</span><span class="p">:</span> <span class="p">{}},</span>  <span class="c1"># Aiven.io membutuhkan koneksi SSL</span>
    <span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="c1"># Menjalankan query untuk mengambil data tanpa kolom &#39;species&#39;</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT sepalLengthCm, sepalWidthCm, petalLengthCm, petalWidthCm FROM defaultdb.irissql;&quot;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="c1"># Mengambil nama kolom</span>
    <span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>

    <span class="c1"># Menampilkan hasil dalam bentuk tabel</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>
    <span class="n">data_remove_class</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>  <span class="c1"># atau df.values</span>

    <span class="c1"># Menampilkan DataFrame tanpa kolom species (kalau ada)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data tanpa kolom &#39;species&#39;:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">))</span>

<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

<span class="k">finally</span><span class="p">:</span>
    <span class="c1"># Menutup koneksi</span>
    <span class="k">if</span> <span class="n">cur</span><span class="p">:</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">conn</span><span class="p">:</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data tanpa kolom &#39;species&#39;:
+-----+-----------------+----------------+-----------------+----------------+
|     |   sepalLengthCm |   sepalWidthCm |   petalLengthCm |   petalWidthCm |
|-----+-----------------+----------------+-----------------+----------------|
|   0 |             5.1 |            3.5 |             1.4 |            0.2 |
|   1 |             4.9 |            3   |             1.4 |            0.2 |
|   2 |             4.7 |            3.2 |             1.3 |            0.2 |
|   3 |             4.6 |            3.1 |             1.5 |            0.2 |
|   4 |             5   |            3.6 |             1.4 |            0.2 |
|   5 |             5.4 |            3.9 |             1.7 |            0.4 |
|   6 |             4.6 |            3.4 |             1.4 |            0.3 |
|   7 |             5   |            3.4 |             1.5 |            0.2 |
|   8 |             4.4 |            2.9 |             1.4 |            0.2 |
|   9 |             4.9 |            3.1 |             1.5 |            0.1 |
|  10 |             5.4 |            3.7 |             1.5 |            0.2 |
|  11 |             4.8 |            3.4 |             1.6 |            0.2 |
|  12 |             4.8 |            3   |             1.4 |            0.1 |
|  13 |             4.3 |            3   |             1.1 |            0.1 |
|  14 |             5.8 |            4   |             1.2 |            0.2 |
|  15 |             5.7 |            4.4 |             1.5 |            0.4 |
|  16 |             5.4 |            3.9 |             1.3 |            0.4 |
|  17 |             5.1 |            3.5 |             1.4 |            0.3 |
|  18 |             5.7 |            3.8 |             1.7 |            0.3 |
|  19 |             5.1 |            3.8 |             1.5 |            0.3 |
|  20 |             5.4 |            3.4 |             1.7 |            0.2 |
|  21 |             5.1 |            3.7 |             1.5 |            0.4 |
|  22 |             4.6 |            3.6 |             1   |            0.2 |
|  23 |             5.1 |            3.3 |             1.7 |            0.5 |
|  24 |             4.8 |            3.4 |             1.9 |            0.2 |
|  25 |             5   |            3   |             1.6 |            0.2 |
|  26 |             5   |            3.4 |             1.6 |            0.4 |
|  27 |             5.2 |            3.5 |             1.5 |            0.2 |
|  28 |             5.2 |            3.4 |             1.4 |            0.2 |
|  29 |             4.7 |            3.2 |             1.6 |            0.2 |
|  30 |             4.8 |            3.1 |             1.6 |            0.2 |
|  31 |             5.4 |            3.4 |             1.5 |            0.4 |
|  32 |             5.2 |            4.1 |             1.5 |            0.1 |
|  33 |             5.5 |            4.2 |             1.4 |            0.2 |
|  34 |             4.9 |            3.1 |             1.5 |            0.1 |
|  35 |             5   |            3.2 |             1.2 |            0.2 |
|  36 |             5.5 |            3.5 |             1.3 |            0.2 |
|  37 |             4.9 |            3.1 |             1.5 |            0.1 |
|  38 |             4.4 |            3   |             1.3 |            0.2 |
|  39 |             5.1 |            3.4 |             1.5 |            0.2 |
|  40 |             5   |            3.5 |             1.3 |            0.3 |
|  41 |             4.5 |            2.3 |             1.3 |            0.3 |
|  42 |             4.4 |            3.2 |             1.3 |            0.2 |
|  43 |             5   |            3.5 |             1.6 |            0.6 |
|  44 |             5.1 |            3.8 |             1.9 |            0.4 |
|  45 |             4.8 |            3   |             1.4 |            0.3 |
|  46 |             5.1 |            3.8 |             1.6 |            0.2 |
|  47 |             4.6 |            3.2 |             1.4 |            0.2 |
|  48 |             5.3 |            3.7 |             1.5 |            0.2 |
|  49 |             5   |            3.3 |             1.4 |            0.2 |
|  50 |             7   |            3.2 |             4.7 |            1.4 |
|  51 |             6.4 |            3.2 |             4.5 |            1.5 |
|  52 |             6.9 |            3.1 |             4.9 |            1.5 |
|  53 |             5.5 |            2.3 |             4   |            1.3 |
|  54 |             6.5 |            2.8 |             4.6 |            1.5 |
|  55 |             5.7 |            2.8 |             4.5 |            1.3 |
|  56 |             6.3 |            3.3 |             4.7 |            1.6 |
|  57 |             4.9 |            2.4 |             3.3 |            1   |
|  58 |             6.6 |            2.9 |             4.6 |            1.3 |
|  59 |             5.2 |            2.7 |             3.9 |            1.4 |
|  60 |             5   |            2   |             3.5 |            1   |
|  61 |             5.9 |            3   |             4.2 |            1.5 |
|  62 |             6   |            2.2 |             4   |            1   |
|  63 |             6.1 |            2.9 |             4.7 |            1.4 |
|  64 |             5.6 |            2.9 |             3.6 |            1.3 |
|  65 |             6.7 |            3.1 |             4.4 |            1.4 |
|  66 |             5.6 |            3   |             4.5 |            1.5 |
|  67 |             5.8 |            2.7 |             4.1 |            1   |
|  68 |             6.2 |            2.2 |             4.5 |            1.5 |
|  69 |             5.6 |            2.5 |             3.9 |            1.1 |
|  70 |             5.9 |            3.2 |             4.8 |            1.8 |
|  71 |             6.1 |            2.8 |             4   |            1.3 |
|  72 |             6.3 |            2.5 |             4.9 |            1.5 |
|  73 |             6.1 |            2.8 |             4.7 |            1.2 |
|  74 |             6.4 |            2.9 |             4.3 |            1.3 |
|  75 |             6.6 |            3   |             4.4 |            1.4 |
|  76 |             6.8 |            2.8 |             4.8 |            1.4 |
|  77 |             6.7 |            3   |             5   |            1.7 |
|  78 |             6   |            2.9 |             4.5 |            1.5 |
|  79 |             5.7 |            2.6 |             3.5 |            1   |
|  80 |             5.5 |            2.4 |             3.8 |            1.1 |
|  81 |             5.5 |            2.4 |             3.7 |            1   |
|  82 |             5.8 |            2.7 |             3.9 |            1.2 |
|  83 |             6   |            2.7 |             5.1 |            1.6 |
|  84 |             5.4 |            3   |             4.5 |            1.5 |
|  85 |             6   |            3.4 |             4.5 |            1.6 |
|  86 |             6.7 |            3.1 |             4.7 |            1.5 |
|  87 |             6.3 |            2.3 |             4.4 |            1.3 |
|  88 |             5.6 |            3   |             4.1 |            1.3 |
|  89 |             5.5 |            2.5 |             4   |            1.3 |
|  90 |             5.5 |            2.6 |             4.4 |            1.2 |
|  91 |             6.1 |            3   |             4.6 |            1.4 |
|  92 |             5.8 |            2.6 |             4   |            1.2 |
|  93 |             5   |            2.3 |             3.3 |            1   |
|  94 |             5.6 |            2.7 |             4.2 |            1.3 |
|  95 |             5.7 |            3   |             4.2 |            1.2 |
|  96 |             5.7 |            2.9 |             4.2 |            1.3 |
|  97 |             6.2 |            2.9 |             4.3 |            1.3 |
|  98 |             5.1 |            2.5 |             3   |            1.1 |
|  99 |             5.7 |            2.8 |             4.1 |            1.3 |
| 100 |             6.3 |            3.3 |             6   |            2.5 |
| 101 |             5.8 |            2.7 |             5.1 |            1.9 |
| 102 |             7.1 |            3   |             5.9 |            2.1 |
| 103 |             6.3 |            2.9 |             5.6 |            1.8 |
| 104 |             6.5 |            3   |             5.8 |            2.2 |
| 105 |             7.6 |            3   |             6.6 |            2.1 |
| 106 |             4.9 |            2.5 |             4.5 |            1.7 |
| 107 |             7.3 |            2.9 |             6.3 |            1.8 |
| 108 |             6.7 |            2.5 |             5.8 |            1.8 |
| 109 |             7.2 |            3.6 |             6.1 |            2.5 |
| 110 |             6.5 |            3.2 |             5.1 |            2   |
| 111 |             6.4 |            2.7 |             5.3 |            1.9 |
| 112 |             6.8 |            3   |             5.5 |            2.1 |
| 113 |             5.7 |            2.5 |             5   |            2   |
| 114 |             5.8 |            2.8 |             5.1 |            2.4 |
| 115 |             6.4 |            3.2 |             5.3 |            2.3 |
| 116 |             6.5 |            3   |             5.5 |            1.8 |
| 117 |             7.7 |            3.8 |             6.7 |            2.2 |
| 118 |             7.7 |            2.6 |             6.9 |            2.3 |
| 119 |             6   |            2.2 |             5   |            1.5 |
| 120 |             6.9 |            3.2 |             5.7 |            2.3 |
| 121 |             5.6 |            2.8 |             4.9 |            2   |
| 122 |             7.7 |            2.8 |             6.7 |            2   |
| 123 |             6.3 |            2.7 |             4.9 |            1.8 |
| 124 |             6.7 |            3.3 |             5.7 |            2.1 |
| 125 |             7.2 |            3.2 |             6   |            1.8 |
| 126 |             6.2 |            2.8 |             4.8 |            1.8 |
| 127 |             6.1 |            3   |             4.9 |            1.8 |
| 128 |             6.4 |            2.8 |             5.6 |            2.1 |
| 129 |             7.2 |            3   |             5.8 |            1.6 |
| 130 |             7.4 |            2.8 |             6.1 |            1.9 |
| 131 |             7.9 |            3.8 |             6.4 |            2   |
| 132 |             6.4 |            2.8 |             5.6 |            2.2 |
| 133 |             6.3 |            2.8 |             5.1 |            1.5 |
| 134 |             6.1 |            2.6 |             5.6 |            1.4 |
| 135 |             7.7 |            3   |             6.1 |            2.3 |
| 136 |             6.3 |            3.4 |             5.6 |            2.4 |
| 137 |             6.4 |            3.1 |             5.5 |            1.8 |
| 138 |             6   |            3   |             4.8 |            1.8 |
| 139 |             6.9 |            3.1 |             5.4 |            2.1 |
| 140 |             6.7 |            3.1 |             5.6 |            2.4 |
| 141 |             6.9 |            3.1 |             5.1 |            2.3 |
| 142 |             5.8 |            2.7 |             5.1 |            1.9 |
| 143 |             6.8 |            3.2 |             5.9 |            2.3 |
| 144 |             6.7 |            3.3 |             5.7 |            2.5 |
| 145 |             6.7 |            3   |             5.2 |            2.3 |
| 146 |             6.3 |            2.5 |             5   |            1.9 |
| 147 |             6.5 |            3   |             5.2 |            2   |
| 148 |             6.2 |            3.4 |             5.4 |            2.3 |
| 149 |             5.9 |            3   |             5.1 |            1.8 |
+-----+-----------------+----------------+-----------------+----------------+
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Inisialisasi scaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="c1"># Normalisasi data (fit &amp; transform)</span>
<span class="n">data_normalized</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_remove_class</span><span class="p">)</span>

<span class="c1"># Cek hasil normalisasi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data setelah normalisasi:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_normalized</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data setelah normalisasi:
[[-9.00681170e-01  1.03205722e+00 -1.34127240e+00 -1.31297673e+00]
 [-1.14301691e+00 -1.24957601e-01 -1.34127240e+00 -1.31297673e+00]
 [-1.38535265e+00  3.37848329e-01 -1.39813811e+00 -1.31297673e+00]
 [-1.50652052e+00  1.06445364e-01 -1.28440670e+00 -1.31297673e+00]
 [-1.02184904e+00  1.26346019e+00 -1.34127240e+00 -1.31297673e+00]
 [-5.37177559e-01  1.95766909e+00 -1.17067529e+00 -1.05003079e+00]
 [-1.50652052e+00  8.00654259e-01 -1.34127240e+00 -1.18150376e+00]
 [-1.02184904e+00  8.00654259e-01 -1.28440670e+00 -1.31297673e+00]
 [-1.74885626e+00 -3.56360566e-01 -1.34127240e+00 -1.31297673e+00]
 [-1.14301691e+00  1.06445364e-01 -1.28440670e+00 -1.44444970e+00]
 [-5.37177559e-01  1.49486315e+00 -1.28440670e+00 -1.31297673e+00]
 [-1.26418478e+00  8.00654259e-01 -1.22754100e+00 -1.31297673e+00]
 [-1.26418478e+00 -1.24957601e-01 -1.34127240e+00 -1.44444970e+00]
 [-1.87002413e+00 -1.24957601e-01 -1.51186952e+00 -1.44444970e+00]
 [-5.25060772e-02  2.18907205e+00 -1.45500381e+00 -1.31297673e+00]
 [-1.73673948e-01  3.11468391e+00 -1.28440670e+00 -1.05003079e+00]
 [-5.37177559e-01  1.95766909e+00 -1.39813811e+00 -1.05003079e+00]
 [-9.00681170e-01  1.03205722e+00 -1.34127240e+00 -1.18150376e+00]
 [-1.73673948e-01  1.72626612e+00 -1.17067529e+00 -1.18150376e+00]
 [-9.00681170e-01  1.72626612e+00 -1.28440670e+00 -1.18150376e+00]
 [-5.37177559e-01  8.00654259e-01 -1.17067529e+00 -1.31297673e+00]
 [-9.00681170e-01  1.49486315e+00 -1.28440670e+00 -1.05003079e+00]
 [-1.50652052e+00  1.26346019e+00 -1.56873522e+00 -1.31297673e+00]
 [-9.00681170e-01  5.69251294e-01 -1.17067529e+00 -9.18557817e-01]
 [-1.26418478e+00  8.00654259e-01 -1.05694388e+00 -1.31297673e+00]
 [-1.02184904e+00 -1.24957601e-01 -1.22754100e+00 -1.31297673e+00]
 [-1.02184904e+00  8.00654259e-01 -1.22754100e+00 -1.05003079e+00]
 [-7.79513300e-01  1.03205722e+00 -1.28440670e+00 -1.31297673e+00]
 [-7.79513300e-01  8.00654259e-01 -1.34127240e+00 -1.31297673e+00]
 [-1.38535265e+00  3.37848329e-01 -1.22754100e+00 -1.31297673e+00]
 [-1.26418478e+00  1.06445364e-01 -1.22754100e+00 -1.31297673e+00]
 [-5.37177559e-01  8.00654259e-01 -1.28440670e+00 -1.05003079e+00]
 [-7.79513300e-01  2.42047502e+00 -1.28440670e+00 -1.44444970e+00]
 [-4.16009689e-01  2.65187798e+00 -1.34127240e+00 -1.31297673e+00]
 [-1.14301691e+00  1.06445364e-01 -1.28440670e+00 -1.44444970e+00]
 [-1.02184904e+00  3.37848329e-01 -1.45500381e+00 -1.31297673e+00]
 [-4.16009689e-01  1.03205722e+00 -1.39813811e+00 -1.31297673e+00]
 [-1.14301691e+00  1.06445364e-01 -1.28440670e+00 -1.44444970e+00]
 [-1.74885626e+00 -1.24957601e-01 -1.39813811e+00 -1.31297673e+00]
 [-9.00681170e-01  8.00654259e-01 -1.28440670e+00 -1.31297673e+00]
 [-1.02184904e+00  1.03205722e+00 -1.39813811e+00 -1.18150376e+00]
 [-1.62768839e+00 -1.74477836e+00 -1.39813811e+00 -1.18150376e+00]
 [-1.74885626e+00  3.37848329e-01 -1.39813811e+00 -1.31297673e+00]
 [-1.02184904e+00  1.03205722e+00 -1.22754100e+00 -7.87084847e-01]
 [-9.00681170e-01  1.72626612e+00 -1.05694388e+00 -1.05003079e+00]
 [-1.26418478e+00 -1.24957601e-01 -1.34127240e+00 -1.18150376e+00]
 [-9.00681170e-01  1.72626612e+00 -1.22754100e+00 -1.31297673e+00]
 [-1.50652052e+00  3.37848329e-01 -1.34127240e+00 -1.31297673e+00]
 [-6.58345429e-01  1.49486315e+00 -1.28440670e+00 -1.31297673e+00]
 [-1.02184904e+00  5.69251294e-01 -1.34127240e+00 -1.31297673e+00]
 [ 1.40150837e+00  3.37848329e-01  5.35295827e-01  2.64698913e-01]
 [ 6.74501145e-01  3.37848329e-01  4.21564419e-01  3.96171883e-01]
 [ 1.28034050e+00  1.06445364e-01  6.49027235e-01  3.96171883e-01]
 [-4.16009689e-01 -1.74477836e+00  1.37235899e-01  1.33225943e-01]
 [ 7.95669016e-01 -5.87763531e-01  4.78430123e-01  3.96171883e-01]
 [-1.73673948e-01 -5.87763531e-01  4.21564419e-01  1.33225943e-01]
 [ 5.53333275e-01  5.69251294e-01  5.35295827e-01  5.27644853e-01]
 [-1.14301691e+00 -1.51337539e+00 -2.60824029e-01 -2.61192967e-01]
 [ 9.16836886e-01 -3.56360566e-01  4.78430123e-01  1.33225943e-01]
 [-7.79513300e-01 -8.19166497e-01  8.03701950e-02  2.64698913e-01]
 [-1.02184904e+00 -2.43898725e+00 -1.47092621e-01 -2.61192967e-01]
 [ 6.86617933e-02 -1.24957601e-01  2.50967307e-01  3.96171883e-01]
 [ 1.89829664e-01 -1.97618132e+00  1.37235899e-01 -2.61192967e-01]
 [ 3.10997534e-01 -3.56360566e-01  5.35295827e-01  2.64698913e-01]
 [-2.94841818e-01 -3.56360566e-01 -9.02269170e-02  1.33225943e-01]
 [ 1.03800476e+00  1.06445364e-01  3.64698715e-01  2.64698913e-01]
 [-2.94841818e-01 -1.24957601e-01  4.21564419e-01  3.96171883e-01]
 [-5.25060772e-02 -8.19166497e-01  1.94101603e-01 -2.61192967e-01]
 [ 4.32165405e-01 -1.97618132e+00  4.21564419e-01  3.96171883e-01]
 [-2.94841818e-01 -1.28197243e+00  8.03701950e-02 -1.29719997e-01]
 [ 6.86617933e-02  3.37848329e-01  5.92161531e-01  7.90590793e-01]
 [ 3.10997534e-01 -5.87763531e-01  1.37235899e-01  1.33225943e-01]
 [ 5.53333275e-01 -1.28197243e+00  6.49027235e-01  3.96171883e-01]
 [ 3.10997534e-01 -5.87763531e-01  5.35295827e-01  1.75297293e-03]
 [ 6.74501145e-01 -3.56360566e-01  3.07833011e-01  1.33225943e-01]
 [ 9.16836886e-01 -1.24957601e-01  3.64698715e-01  2.64698913e-01]
 [ 1.15917263e+00 -5.87763531e-01  5.92161531e-01  2.64698913e-01]
 [ 1.03800476e+00 -1.24957601e-01  7.05892939e-01  6.59117823e-01]
 [ 1.89829664e-01 -3.56360566e-01  4.21564419e-01  3.96171883e-01]
 [-1.73673948e-01 -1.05056946e+00 -1.47092621e-01 -2.61192967e-01]
 [-4.16009689e-01 -1.51337539e+00  2.35044910e-02 -1.29719997e-01]
 [-4.16009689e-01 -1.51337539e+00 -3.33612130e-02 -2.61192967e-01]
 [-5.25060772e-02 -8.19166497e-01  8.03701950e-02  1.75297293e-03]
 [ 1.89829664e-01 -8.19166497e-01  7.62758643e-01  5.27644853e-01]
 [-5.37177559e-01 -1.24957601e-01  4.21564419e-01  3.96171883e-01]
 [ 1.89829664e-01  8.00654259e-01  4.21564419e-01  5.27644853e-01]
 [ 1.03800476e+00  1.06445364e-01  5.35295827e-01  3.96171883e-01]
 [ 5.53333275e-01 -1.74477836e+00  3.64698715e-01  1.33225943e-01]
 [-2.94841818e-01 -1.24957601e-01  1.94101603e-01  1.33225943e-01]
 [-4.16009689e-01 -1.28197243e+00  1.37235899e-01  1.33225943e-01]
 [-4.16009689e-01 -1.05056946e+00  3.64698715e-01  1.75297293e-03]
 [ 3.10997534e-01 -1.24957601e-01  4.78430123e-01  2.64698913e-01]
 [-5.25060772e-02 -1.05056946e+00  1.37235899e-01  1.75297293e-03]
 [-1.02184904e+00 -1.74477836e+00 -2.60824029e-01 -2.61192967e-01]
 [-2.94841818e-01 -8.19166497e-01  2.50967307e-01  1.33225943e-01]
 [-1.73673948e-01 -1.24957601e-01  2.50967307e-01  1.75297293e-03]
 [-1.73673948e-01 -3.56360566e-01  2.50967307e-01  1.33225943e-01]
 [ 4.32165405e-01 -3.56360566e-01  3.07833011e-01  1.33225943e-01]
 [-9.00681170e-01 -1.28197243e+00 -4.31421141e-01 -1.29719997e-01]
 [-1.73673948e-01 -5.87763531e-01  1.94101603e-01  1.33225943e-01]
 [ 5.53333275e-01  5.69251294e-01  1.27454998e+00  1.71090158e+00]
 [-5.25060772e-02 -8.19166497e-01  7.62758643e-01  9.22063763e-01]
 [ 1.52267624e+00 -1.24957601e-01  1.21768427e+00  1.18500970e+00]
 [ 5.53333275e-01 -3.56360566e-01  1.04708716e+00  7.90590793e-01]
 [ 7.95669016e-01 -1.24957601e-01  1.16081857e+00  1.31648267e+00]
 [ 2.12851559e+00 -1.24957601e-01  1.61574420e+00  1.18500970e+00]
 [-1.14301691e+00 -1.28197243e+00  4.21564419e-01  6.59117823e-01]
 [ 1.76501198e+00 -3.56360566e-01  1.44514709e+00  7.90590793e-01]
 [ 1.03800476e+00 -1.28197243e+00  1.16081857e+00  7.90590793e-01]
 [ 1.64384411e+00  1.26346019e+00  1.33141568e+00  1.71090158e+00]
 [ 7.95669016e-01  3.37848329e-01  7.62758643e-01  1.05353673e+00]
 [ 6.74501145e-01 -8.19166497e-01  8.76490051e-01  9.22063763e-01]
 [ 1.15917263e+00 -1.24957601e-01  9.90221459e-01  1.18500970e+00]
 [-1.73673948e-01 -1.28197243e+00  7.05892939e-01  1.05353673e+00]
 [-5.25060772e-02 -5.87763531e-01  7.62758643e-01  1.57942861e+00]
 [ 6.74501145e-01  3.37848329e-01  8.76490051e-01  1.44795564e+00]
 [ 7.95669016e-01 -1.24957601e-01  9.90221459e-01  7.90590793e-01]
 [ 2.24968346e+00  1.72626612e+00  1.67260991e+00  1.31648267e+00]
 [ 2.24968346e+00 -1.05056946e+00  1.78634131e+00  1.44795564e+00]
 [ 1.89829664e-01 -1.97618132e+00  7.05892939e-01  3.96171883e-01]
 [ 1.28034050e+00  3.37848329e-01  1.10395287e+00  1.44795564e+00]
 [-2.94841818e-01 -5.87763531e-01  6.49027235e-01  1.05353673e+00]
 [ 2.24968346e+00 -5.87763531e-01  1.67260991e+00  1.05353673e+00]
 [ 5.53333275e-01 -8.19166497e-01  6.49027235e-01  7.90590793e-01]
 [ 1.03800476e+00  5.69251294e-01  1.10395287e+00  1.18500970e+00]
 [ 1.64384411e+00  3.37848329e-01  1.27454998e+00  7.90590793e-01]
 [ 4.32165405e-01 -5.87763531e-01  5.92161531e-01  7.90590793e-01]
 [ 3.10997534e-01 -1.24957601e-01  6.49027235e-01  7.90590793e-01]
 [ 6.74501145e-01 -5.87763531e-01  1.04708716e+00  1.18500970e+00]
 [ 1.64384411e+00 -1.24957601e-01  1.16081857e+00  5.27644853e-01]
 [ 1.88617985e+00 -5.87763531e-01  1.33141568e+00  9.22063763e-01]
 [ 2.49201920e+00  1.72626612e+00  1.50201279e+00  1.05353673e+00]
 [ 6.74501145e-01 -5.87763531e-01  1.04708716e+00  1.31648267e+00]
 [ 5.53333275e-01 -5.87763531e-01  7.62758643e-01  3.96171883e-01]
 [ 3.10997534e-01 -1.05056946e+00  1.04708716e+00  2.64698913e-01]
 [ 2.24968346e+00 -1.24957601e-01  1.33141568e+00  1.44795564e+00]
 [ 5.53333275e-01  8.00654259e-01  1.04708716e+00  1.57942861e+00]
 [ 6.74501145e-01  1.06445364e-01  9.90221459e-01  7.90590793e-01]
 [ 1.89829664e-01 -1.24957601e-01  5.92161531e-01  7.90590793e-01]
 [ 1.28034050e+00  1.06445364e-01  9.33355755e-01  1.18500970e+00]
 [ 1.03800476e+00  1.06445364e-01  1.04708716e+00  1.57942861e+00]
 [ 1.28034050e+00  1.06445364e-01  7.62758643e-01  1.44795564e+00]
 [-5.25060772e-02 -8.19166497e-01  7.62758643e-01  9.22063763e-01]
 [ 1.15917263e+00  3.37848329e-01  1.21768427e+00  1.44795564e+00]
 [ 1.03800476e+00  5.69251294e-01  1.10395287e+00  1.71090158e+00]
 [ 1.03800476e+00 -1.24957601e-01  8.19624347e-01  1.44795564e+00]
 [ 5.53333275e-01 -1.28197243e+00  7.05892939e-01  9.22063763e-01]
 [ 7.95669016e-01 -1.24957601e-01  8.19624347e-01  1.05353673e+00]
 [ 4.32165405e-01  8.00654259e-01  9.33355755e-01  1.44795564e+00]
 [ 6.86617933e-02 -1.24957601e-01  7.62758643e-01  7.90590793e-01]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tabulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span> <span class="c1"># Untuk memuat data Iris</span>

<span class="c1"># --- 1. Persiapan Data Iris ---</span>
<span class="c1"># Memuat dataset Iris dan menormalisasinya.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Persiapan Data ---&quot;</span><span class="p">)</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X_original</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span> <span class="c1"># Data Iris asli</span>

<span class="c1"># Normalisasi Data: Penting untuk FCM agar fitur memiliki skala yang seragam.</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_original</span><span class="p">)</span> <span class="c1"># X adalah data yang sudah dinormalisasi, akan jadi input FCM</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Iris asli (5 baris pertama):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_original</span><span class="p">[:</span><span class="mi">5</span><span class="p">]),</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Iris setelah normalisasi (5 baris pertama):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">]),</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bentuk data input (X): </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- 2. Parameter FCM ---</span>
<span class="n">NUM_CLUSTERS</span> <span class="o">=</span> <span class="mi">3</span>       <span class="c1"># Jumlah cluster yang diinginkan (C)</span>
<span class="n">FUZZINESS_PARAM</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># Parameter fuzziness (m). m &gt; 1, umumnya 2.0.</span>

<span class="n">CONVERGENCE_TOLERANCE</span> <span class="o">=</span> <span class="mf">1e-4</span> <span class="c1"># Toleransi konvergensi (epsilon)</span>
<span class="n">MAX_ITERATIONS</span> <span class="o">=</span> <span class="mi">100</span>       <span class="c1"># Batas iterasi maksimum</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===== PARAMETER FCM =====&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah Cluster: </span><span class="si">{</span><span class="n">NUM_CLUSTERS</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter Fuzziness (m): </span><span class="si">{</span><span class="n">FUZZINESS_PARAM</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Toleransi Konvergensi: </span><span class="si">{</span><span class="n">CONVERGENCE_TOLERANCE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maksimum Iterasi: </span><span class="si">{</span><span class="n">MAX_ITERATIONS</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- 3. Fungsi-fungsi Inti Fuzzy C-Means (FCM) ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">initialize_membership_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_clusters_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Menginisialisasi matriks keanggotaan (U) secara acak.</span>
<span class="sd">    Setiap baris menunjukkan satu titik data, setiap kolom adalah satu cluster.</span>
<span class="sd">    Jumlah keanggotaan untuk setiap titik data (baris) harus berjumlah 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># Untuk hasil yang konsisten</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Buat matriks acak</span>
    <span class="n">U_initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">,</span> <span class="n">num_clusters_val</span><span class="p">)</span>

    <span class="c1"># Normalisasi setiap baris agar jumlahnya 1</span>
    <span class="c1"># np.sum(U_initial, axis=1, keepdims=True) akan menghasilkan array kolom berisi jumlah setiap baris</span>
    <span class="n">U_normalized</span> <span class="o">=</span> <span class="n">U_initial</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">U_initial</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; Matriks Keanggotaan Awal (U) diinisialisasi.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">U_normalized</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_centroids</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">U_matrix</span><span class="p">,</span> <span class="n">fuzziness_param_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Menghitung pusat setiap cluster (centroid) berdasarkan matriks keanggotaan saat ini.</span>
<span class="sd">    Rumus: V_j = (SUM_{i=1 to N} (u_ij^m * x_i)) / (SUM_{i=1 to N} (u_ij^m))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">num_dimensions</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">num_clusters_val</span> <span class="o">=</span> <span class="n">U_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_clusters_val</span><span class="p">,</span> <span class="n">num_dimensions</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters_val</span><span class="p">):</span> <span class="c1"># Loop untuk setiap cluster</span>
        <span class="n">u_ij_pow_m</span> <span class="o">=</span> <span class="n">U_matrix</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">**</span> <span class="n">fuzziness_param_val</span> <span class="c1"># Derajat keanggotaan kolom j dipangkatkan m</span>

        <span class="c1"># Pembilang: jumlah dari (u_ij^m * x_i)</span>
        <span class="c1"># Menggunakan broadcasting: u_ij_pow_m (kolom) * data (matrix)</span>
        <span class="n">numerator_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">u_ij_pow_m</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Penyebut: jumlah dari (u_ij^m)</span>
        <span class="n">denominator_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">u_ij_pow_m</span><span class="p">)</span>

        <span class="c1"># Menghindari pembagian dengan nol jika cluster kosong</span>
        <span class="k">if</span> <span class="n">denominator_sum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dimensions</span><span class="p">)</span>
            <span class="c1"># print(f&quot;  Peringatan: Cluster {j+1} memiliki bobot total nol, centroid diatur ke nol.&quot;)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerator_sum</span> <span class="o">/</span> <span class="n">denominator_sum</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; Centroid dihitung.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centroids</span>

<span class="k">def</span><span class="w"> </span><span class="nf">update_membership_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids_matrix</span><span class="p">,</span> <span class="n">fuzziness_param_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Memperbarui matriks keanggotaan (U) berdasarkan centroid yang baru.</span>
<span class="sd">    Rumus: u_ij = 1 / (SUM_{k=1 to C} ((||x_i - V_j|| / ||x_i - V_k||)^(2/(m-1))))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">num_clusters_val</span> <span class="o">=</span> <span class="n">centroids_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">U_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_data_points</span><span class="p">,</span> <span class="n">num_clusters_val</span><span class="p">))</span>

    <span class="c1"># Eksponen untuk perhitungan update keanggotaan</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">fuzziness_param_val</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">):</span> <span class="c1"># Untuk setiap titik data</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters_val</span><span class="p">):</span> <span class="c1"># Untuk setiap cluster (keanggotaan u_ij)</span>
            <span class="c1"># Jarak Euclidean antara x_i dan centroid V_j</span>
            <span class="n">distance_to_cj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

            <span class="c1"># Inisialisasi penyebut total untuk rumus u_ij</span>
            <span class="n">denominator_sum_k</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="c1"># Cek jika jarak_to_cj adalah nol</span>
            <span class="k">if</span> <span class="n">distance_to_cj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Jika titik data persis di centroid V_j, maka keanggotaan u_ij adalah 1</span>
                <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="c1"># Semua keanggotaan lain untuk titik data ini akan 0 karena ini &quot;hard assignment&quot; di titik itu</span>
                <span class="n">denominator_sum_k</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># Pastikan tidak ada pembagian nol di bawah</span>
                <span class="k">break</span> <span class="c1"># Keluar dari loop &#39;j&#39; (cluster) untuk titik data ini</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters_val</span><span class="p">):</span> <span class="c1"># Untuk setiap cluster lain (V_k)</span>
                <span class="c1"># Jarak Euclidean antara x_i dan centroid V_k</span>
                <span class="n">distance_to_ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

                <span class="c1"># Penanganan jika jarak_to_ck adalah nol (titik data persis di centroid V_k)</span>
                <span class="k">if</span> <span class="n">distance_to_ck</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Jika jarak_to_ck nol tapi jarak_to_cj tidak nol, berarti ada centroid lain yang pas.</span>
                    <span class="c1"># Ini akan menyebabkan ZeroDivisionError jika tidak ditangani.</span>
                    <span class="c1"># Kita set ke nilai sangat kecil (machine epsilon) untuk stabilitas numerik.</span>
                    <span class="n">distance_to_ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>

                <span class="c1"># Hitung bagian (||x_i - V_j|| / ||x_i - V_k||)^exponent</span>
                <span class="n">ratio_power</span> <span class="o">=</span> <span class="p">(</span><span class="n">distance_to_cj</span> <span class="o">/</span> <span class="n">distance_to_ck</span><span class="p">)</span> <span class="o">**</span> <span class="n">exponent</span>
                <span class="n">denominator_sum_k</span> <span class="o">+=</span> <span class="n">ratio_power</span>

            <span class="c1"># Hitung u_ij</span>
            <span class="k">if</span> <span class="n">denominator_sum_k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># Ini sangat jarang, hanya jika semua jarak ke semua centroid adalah 0</span>
                <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">num_clusters_val</span> <span class="c1"># Bagi rata</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">denominator_sum_k</span>

    <span class="c1"># Normalisasi setiap baris U_new agar jumlahnya 1 (untuk mengatasi floating point error)</span>
    <span class="n">U_normalized</span> <span class="o">=</span> <span class="n">U_new</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">U_new</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; Matriks Keanggotaan (U) diperbarui.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">U_normalized</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_convergence</span><span class="p">(</span><span class="n">old_centroids</span><span class="p">,</span> <span class="n">new_centroids</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Memeriksa konvergensi algoritma dengan menghitung total perubahan</span>
<span class="sd">    antara centroid lama dan centroid baru.</span>
<span class="sd">    Jika perubahan di bawah toleransi, algoritma dianggap konvergen.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_delta</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">old_centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="c1"># Menjumlahkan jarak Euclidean antara setiap pasangan centroid</span>
        <span class="n">total_delta</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">old_centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">new_centroids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  -&gt; Perubahan centroid: </span><span class="si">{</span><span class="n">total_delta</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total_delta</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">total_delta</span> <span class="c1"># Mengembalikan boolean dan nilai delta</span>

<span class="c1"># --- 4. Alur Utama Algoritma Fuzzy C-Means ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==================== MEMULAI ALGORITMA FUZZY C-MEANS ====================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Inisialisasi U</span>
<span class="n">U_current</span> <span class="o">=</span> <span class="n">initialize_membership_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">NUM_CLUSTERS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriks Keanggotaan Awal (5 baris pertama):</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">centroids_old</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">has_converged</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">last_delta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

<span class="k">while</span> <span class="n">iteration</span> <span class="o">&lt;</span> <span class="n">MAX_ITERATIONS</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_converged</span><span class="p">:</span>
    <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===== ITERASI </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> =====&quot;</span><span class="p">)</span>

    <span class="c1"># LANGKAH A: Hitung Centroid Baru</span>
    <span class="n">centroids_new</span> <span class="o">=</span> <span class="n">calculate_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U_current</span><span class="p">,</span> <span class="n">FUZZINESS_PARAM</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Centroid setelah Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">centroids_new</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># LANGKAH B: Cek Konvergensi (setelah iterasi pertama)</span>
    <span class="k">if</span> <span class="n">iteration</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">has_converged</span><span class="p">,</span> <span class="n">last_delta</span> <span class="o">=</span> <span class="n">check_convergence</span><span class="p">(</span><span class="n">centroids_old</span><span class="p">,</span> <span class="n">centroids_new</span><span class="p">,</span> <span class="n">CONVERGENCE_TOLERANCE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_converged</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; **KONVERGENSI TERCAPAI!** Perubahan centroid di bawah toleransi.&quot;</span><span class="p">)</span>
            <span class="k">break</span> <span class="c1"># Hentikan loop</span>

    <span class="c1"># Simpan centroid yang baru dihitung untuk perbandingan di iterasi berikutnya</span>
    <span class="n">centroids_old</span> <span class="o">=</span> <span class="n">centroids_new</span>

    <span class="c1"># LANGKAH C: Perbarui Matriks Keanggotaan</span>
    <span class="n">U_current</span> <span class="o">=</span> <span class="n">update_membership_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids_new</span><span class="p">,</span> <span class="n">FUZZINESS_PARAM</span><span class="p">)</span>

    <span class="c1"># Menampilkan sebagian matriks U karena bisa sangat besar</span>
    <span class="k">if</span> <span class="n">U_current</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriks Keanggotaan (U) setelah Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> (5 baris pertama):</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriks Keanggotaan (U) setelah Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- 5. Hasil Akhir Clustering Fuzzy C-Means ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">==================== HASIL AKHIR CLUSTERING FUZZY C-MEANS ====================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah Iterasi yang Berjalan: </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Toleransi Konvergensi Epsilon: </span><span class="si">{</span><span class="n">CONVERGENCE_TOLERANCE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Perubahan Centroid Terakhir: </span><span class="si">{</span><span class="n">last_delta</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Centroid Akhir:</span><span class="se">\n</span><span class="si">{</span><span class="n">centroids_new</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matriks Keanggotaan Akhir (U) (5 baris pertama):</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Interpretasi Hasil (Hard Assignment - Opsional) ---</span>
<span class="c1"># Untuk visualisasi atau pemahaman yang lebih mudah, kita bisa &quot;mengubah&quot; hasil fuzzy</span>
<span class="c1"># menjadi penugasan cluster yang &quot;keras&quot; (hard assignment).</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Penugasan Cluster (Hard Assignment - Untuk Interpretasi) ---&quot;</span><span class="p">)</span>
<span class="n">cluster_assignment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">U_current</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Mengambil indeks kolom dengan nilai tertinggi di setiap baris</span>

<span class="c1"># Tampilkan penugasan untuk beberapa data poin</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))):</span> <span class="c1"># Tampilkan 10 data poin pertama</span>
    <span class="c1"># Menampilkan data asli dan normalisasi untuk perbandingan</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data Asli ke-</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">X_original</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">) -&gt; Normalisasi (</span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">) -&gt; Paling condong ke Cluster </span><span class="si">{</span><span class="n">cluster_assignment</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Algoritma Fuzzy C-Means Selesai Dijalankan!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Persiapan Data ---
Data Iris asli (5 baris pertama):
 +----+-----+-----+-----+-----+
|    |   0 |   1 |   2 |   3 |
|----+-----+-----+-----+-----|
|  0 | 5.1 | 3.5 | 1.4 | 0.2 |
|  1 | 4.9 | 3   | 1.4 | 0.2 |
|  2 | 4.7 | 3.2 | 1.3 | 0.2 |
|  3 | 4.6 | 3.1 | 1.5 | 0.2 |
|  4 | 5   | 3.6 | 1.4 | 0.2 |
+----+-----+-----+-----+-----+

Data Iris setelah normalisasi (5 baris pertama):
 +----+-----------+------------+----------+----------+
|    |         0 |          1 |        2 |        3 |
|----+-----------+------------+----------+----------|
|  0 | -0.900681 |  1.019     | -1.34023 | -1.31544 |
|  1 | -1.14302  | -0.131979  | -1.34023 | -1.31544 |
|  2 | -1.38535  |  0.328414  | -1.39706 | -1.31544 |
|  3 | -1.50652  |  0.0982173 | -1.28339 | -1.31544 |
|  4 | -1.02185  |  1.2492    | -1.34023 | -1.31544 |
+----+-----------+------------+----------+----------+

Bentuk data input (X): (150, 4)

===== PARAMETER FCM =====
Jumlah Cluster: 3
Parameter Fuzziness (m): 2.0
Toleransi Konvergensi: 0.0001
Maksimum Iterasi: 100

==================== MEMULAI ALGORITMA FUZZY C-MEANS ====================

  -&gt; Matriks Keanggotaan Awal (U) diinisialisasi.
Matriks Keanggotaan Awal (5 baris pertama):
[[0.18205878 0.46212909 0.35581214]
 [0.65738127 0.17132261 0.17129612]
 [0.03807826 0.56784481 0.39407693]
 [0.41686469 0.01211874 0.57101657]
 [0.67865488 0.173111   0.14823412]]


===== ITERASI 1 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 1:
[[ 0.18015492 -0.07895799  0.14860201  0.15783118]
 [ 0.04673142 -0.00414338  0.05866575  0.04549694]
 [-0.21994478  0.10763652 -0.23597937 -0.23185324]]

  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 1 (5 baris pertama):
[[0.2494674  0.29314748 0.45738512]
 [0.2480877  0.29068336 0.46122895]
 [0.25021306 0.29279211 0.45699483]
 [0.25153709 0.29380514 0.45465777]
 [0.25542594 0.29749592 0.44707814]]


===== ITERASI 2 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 2:
[[ 0.32184306 -0.1805122   0.37013276  0.35227467]
 [ 0.09168238 -0.07223049  0.13191807  0.12638803]
 [-0.53229799  0.3315663  -0.64475067 -0.61969803]]

  -&gt; Perubahan centroid: 1.16078266
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 2 (5 baris pertama):
[[0.12775305 0.17188507 0.70036187]
 [0.13495836 0.18358899 0.68145265]
 [0.13423824 0.18029596 0.6854658 ]
 [0.14174222 0.19003133 0.66822644]
 [0.14318196 0.1891916  0.66762645]]


===== ITERASI 3 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 3:
[[ 0.54842153 -0.29010549  0.62566069  0.60271587]
 [ 0.19164575 -0.28365576  0.33878461  0.31553709]
 [-0.91807092  0.66119838 -1.14719383 -1.10547294]]

  -&gt; Perubahan centroid: 1.66616314
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 3 (5 baris pertama):
[[0.01769137 0.02400847 0.95830016]
 [0.06197241 0.08874478 0.84928282]
 [0.03367654 0.04692638 0.91939709]
 [0.05399274 0.07589992 0.87010734]
 [0.03267689 0.04348979 0.92383332]]


===== ITERASI 4 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 4:
[[ 0.75729236 -0.27163118  0.79720003  0.80449727]
 [ 0.18693994 -0.48490762  0.42456647  0.36461684]
 [-1.00775384  0.78085939 -1.26824864 -1.22369912]]

  -&gt; Perubahan centroid: 0.78787712
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 4 (5 baris pertama):
[[0.00597923 0.00858945 0.98543133]
 [0.05782805 0.09374129 0.84843067]
 [0.02448582 0.0376478  0.93786639]
 [0.04536425 0.07140931 0.88322644]
 [0.01543982 0.02157635 0.96298383]]


===== ITERASI 5 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 5:
[[ 0.91520067 -0.1385193   0.89030625  0.92401051]
 [ 0.09740256 -0.618484    0.38934005  0.30687318]
 [-1.01118785  0.81254576 -1.27890281 -1.2338868 ]]

  -&gt; Perubahan centroid: 0.46570825
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 5 (5 baris pertama):
[[0.00441004 0.00693579 0.98865417]
 [0.05438303 0.10457231 0.84104467]
 [0.02344094 0.04141778 0.93514128]
 [0.04276529 0.07864364 0.87859107]
 [0.01243955 0.01880568 0.96875477]]


===== ITERASI 6 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 6:
[[ 1.01131803 -0.03539321  0.94138468  0.99238841]
 [ 0.02395985 -0.71827716  0.35425733  0.26436111]
 [-1.00968312  0.82685112 -1.28231656 -1.23684492]]

  -&gt; Perubahan centroid: 0.31548582
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 6 (5 baris pertama):
[[0.00377473 0.00624999 0.98997528]
 [0.0521259  0.11189493 0.83597917]
 [0.02288477 0.04413232 0.93298291]
 [0.04123853 0.08378506 0.87497641]
 [0.01119343 0.01767655 0.97113001]]


===== ITERASI 7 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 7:
[[ 1.05271844  0.01260556  0.96254383  1.02035291]
 [-0.01134712 -0.77287087  0.33699174  0.24620761]
 [-1.008006    0.83600557 -1.28397448 -1.23824254]]

  -&gt; Perubahan centroid: 0.15167211
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 7 (5 baris pertama):
[[0.00344072 0.00579579 0.99076349]
 [0.05148125 0.11567397 0.83284478]
 [0.02285623 0.04564498 0.93149879]
 [0.04086653 0.08649856 0.87263492]
 [0.0105537  0.01689913 0.97254717]]


===== ITERASI 8 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 8:
[[ 1.06666802  0.03023271  0.96951309  1.02913695]
 [-0.02570045 -0.7978924   0.32986435  0.23919126]
 [-1.00658186  0.84120516 -1.28446324 -1.23859456]]

  -&gt; Perubahan centroid: 0.06107579
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 8 (5 baris pertama):
[[0.00327713 0.00554156 0.99118131]
 [0.05146351 0.11743897 0.83109752]
 [0.02299524 0.04643945 0.93056531]
 [0.04092608 0.08781551 0.8712584 ]
 [0.01025287 0.01646119 0.97328594]]


===== ITERASI 9 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 9:
[[ 1.07040342  0.03598237  0.97122495  1.03119672]
 [-0.03174789 -0.80881614  0.32677023  0.23613266]
 [-1.00572028  0.84383716 -1.28458578 -1.23864684]]

  -&gt; Perubahan centroid: 0.02335594
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 9 (5 baris pertama):
[[0.00320192 0.00541609 0.99138199]
 [0.05156944 0.11826932 0.83016124]
 [0.02311806 0.04684149 0.93004045]
 [0.04104647 0.08845229 0.87050123]
 [0.01012023 0.0162466  0.97363317]]


===== ITERASI 10 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 10:
[[ 1.07092767  0.037628    0.97133109  1.03128832]
 [-0.03460262 -0.8136931   0.32523109  0.23456073]
 [-1.00527289  0.84511521 -1.28462194 -1.23864862]]

  -&gt; Perubahan centroid: 0.00915154
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 10 (5 baris pertama):
[[0.00316791 0.0053568  0.99147529]
 [0.05166315 0.11868036 0.82965649]
 [0.02319667 0.04704525 0.92975808]
 [0.04113793 0.08877091 0.87009116]
 [0.01006267 0.01614645 0.97379088]]


===== ITERASI 11 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 11:
[[ 1.07062836  0.03795517  0.97106733  1.03094055]
 [-0.03611224 -0.81599922  0.32436799  0.23365369]
 [-1.00504871  0.84574215 -1.28463625 -1.23864642]]

  -&gt; Perubahan centroid: 0.00431553
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 11 (5 baris pertama):
[[0.0031522  0.00532857 0.99151922]
 [0.05172661 0.11889729 0.8293761 ]
 [0.02324298 0.04715219 0.92960483]
 [0.04119638 0.0889391  0.86986452]
 [0.0100372  0.01609953 0.97386327]]


===== ITERASI 12 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 12:
[[ 1.07022689  0.03790588  0.97079145  1.03058539]
 [-0.03697796 -0.81716827  0.32384861  0.23309874]
 [-1.00493374  0.84606261 -1.28464336 -1.23864543]]

  -&gt; Perubahan centroid: 0.00258670
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 12 (5 baris pertama):
[[0.0031446  0.00531458 0.99154082]
 [0.05176664 0.11901885 0.8292145 ]
 [0.02327    0.04721114 0.92951886]
 [0.04123215 0.08903297 0.86973488]
 [0.01002537 0.01607672 0.97389791]]


===== ITERASI 13 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 13:
[[ 1.06990223  0.0377821   0.97058144  1.03031556]
 [-0.03749886 -0.81780109  0.32352557  0.23275087]
 [-1.00487194  0.8462354  -1.28464735 -1.23864524]]

  -&gt; Perubahan centroid: 0.00161822
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 13 (5 baris pertama):
[[0.00314067 0.00530726 0.99155207]
 [0.05179148 0.11909021 0.8291183 ]
 [0.02328601 0.04724516 0.92946883]
 [0.04125396 0.08908783 0.86965821]
 [0.0100195  0.016065   0.9739155 ]]


===== ITERASI 14 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 14:
[[ 1.06967341  0.03767015  0.97043711  1.03012972]
 [-0.03782038 -0.8181622   0.32332197  0.23253094]
 [-1.00483702  0.84633341 -1.28464972 -1.23864534]]

  -&gt; Perubahan centroid: 0.00101971
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 14 (5 baris pertama):
[[0.00313852 0.00530321 0.99155827]
 [0.0518069  0.11913345 0.82905965]
 [0.02329567 0.04726551 0.92943881]
 [0.04126737 0.08912095 0.86961168]
 [0.01001637 0.01605862 0.97392501]]


===== ITERASI 15 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 15:
[[ 1.06952092  0.03758706  0.97034212  1.03000708]
 [-0.03802139 -0.8183762   0.32319308  0.23239156]
 [-1.00481649  0.84639125 -1.28465117 -1.23864549]]

  -&gt; Perubahan centroid: 0.00064389
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 15 (5 baris pertama):
[[0.00313728 0.00530086 0.99156187]
 [0.05181652 0.11916015 0.82902333]
 [0.02330161 0.04727797 0.92942042]
 [0.04127568 0.08914136 0.86958296]
 [0.01001461 0.01605496 0.97393042]]


===== ITERASI 16 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 16:
[[ 1.06942191  0.03753002  0.97028086  1.02992778]
 [-0.03814783 -0.81850624  0.3231114   0.23230324]
 [-1.00480405  0.84642634 -1.28465207 -1.23864561]]

  -&gt; Perubahan centroid: 0.00040686
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 16 (5 baris pertama):
[[0.00313653 0.00529945 0.99156402]
 [0.05182254 0.11917682 0.82900064]
 [0.02330529 0.04728571 0.929409  ]
 [0.04128087 0.08915409 0.86956505]
 [0.01001357 0.0160528  0.97393363]]


===== ITERASI 17 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 17:
[[ 1.06935845  0.0374923   0.97024174  1.02987705]
 [-0.03822759 -0.81858652  0.32305965  0.23224729]
 [-1.00479639  0.846448   -1.28465263 -1.2386457 ]]

  -&gt; Perubahan centroid: 0.00025716
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 17 (5 baris pertama):
[[0.00313608 0.00529858 0.99156534]
 [0.05182633 0.1191873  0.82898637]
 [0.0233076  0.04729056 0.92940185]
 [0.04128412 0.08916207 0.8695538 ]
 [0.01001294 0.01605147 0.97393559]]


===== ITERASI 18 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 18:
[[ 1.06931805  0.03746785  0.97021689  1.02984478]
 [-0.03827797 -0.81863657  0.32302689  0.23221187]
 [-1.00479161  0.84646151 -1.28465298 -1.23864576]]

  -&gt; Perubahan centroid: 0.00016255
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 18 (5 baris pertama):
[[0.00313579 0.00529805 0.99156616]
 [0.05182872 0.1191939  0.82897739]
 [0.02330904 0.04729361 0.92939735]
 [0.04128617 0.08916711 0.86954672]
 [0.01001255 0.01605066 0.9739368 ]]


===== ITERASI 19 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 19:
[[ 1.06929241  0.03745216  0.97020113  1.0298243 ]
 [-0.03830981 -0.81866794  0.32300615  0.23218945]
 [-1.00478862  0.84646999 -1.2846532  -1.2386458 ]]

  -&gt; Perubahan centroid: 0.00010276
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 19 (5 baris pertama):
[[0.00313562 0.00529771 0.99156667]
 [0.05183022 0.11919806 0.82897171]
 [0.02330996 0.04729553 0.92939452]
 [0.04128747 0.08917028 0.86954225]
 [0.0100123  0.01605015 0.97393755]]


===== ITERASI 20 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 20:
[[ 1.06927618  0.03744217  0.97019116  1.02981133]
 [-0.03832994 -0.81868768  0.32299303  0.23217528]
 [-1.00478673  0.84647532 -1.28465334 -1.23864583]]

  -&gt; Perubahan centroid: 0.00006496

&gt;&gt;&gt; **KONVERGENSI TERCAPAI!** Perubahan centroid di bawah toleransi.

==================== HASIL AKHIR CLUSTERING FUZZY C-MEANS ====================
Jumlah Iterasi yang Berjalan: 20
Toleransi Konvergensi Epsilon: 0.0001
Perubahan Centroid Terakhir: 0.00006496

Centroid Akhir:
[[ 1.06927618  0.03744217  0.97019116  1.02981133]
 [-0.03832994 -0.81868768  0.32299303  0.23217528]
 [-1.00478673  0.84647532 -1.28465334 -1.23864583]]

Matriks Keanggotaan Akhir (U) (5 baris pertama):
[[0.00313562 0.00529771 0.99156667]
 [0.05183022 0.11919806 0.82897171]
 [0.02330996 0.04729553 0.92939452]
 [0.04128747 0.08917028 0.86954225]
 [0.0100123  0.01605015 0.97393755]]

--- Penugasan Cluster (Hard Assignment - Untuk Interpretasi) ---
Data Asli ke-1 ([5.1 3.5 1.4 0.2]) -&gt; Normalisasi ([-0.9   1.02 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-2 ([4.9 3.  1.4 0.2]) -&gt; Normalisasi ([-1.14 -0.13 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-3 ([4.7 3.2 1.3 0.2]) -&gt; Normalisasi ([-1.39  0.33 -1.4  -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-4 ([4.6 3.1 1.5 0.2]) -&gt; Normalisasi ([-1.51  0.1  -1.28 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-5 ([5.  3.6 1.4 0.2]) -&gt; Normalisasi ([-1.02  1.25 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-6 ([5.4 3.9 1.7 0.4]) -&gt; Normalisasi ([-0.54  1.94 -1.17 -1.05]) -&gt; Paling condong ke Cluster 3
Data Asli ke-7 ([4.6 3.4 1.4 0.3]) -&gt; Normalisasi ([-1.51  0.79 -1.34 -1.18]) -&gt; Paling condong ke Cluster 3
Data Asli ke-8 ([5.  3.4 1.5 0.2]) -&gt; Normalisasi ([-1.02  0.79 -1.28 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-9 ([4.4 2.9 1.4 0.2]) -&gt; Normalisasi ([-1.75 -0.36 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-10 ([4.9 3.1 1.5 0.1]) -&gt; Normalisasi ([-1.14  0.1  -1.28 -1.45]) -&gt; Paling condong ke Cluster 3

Algoritma Fuzzy C-Means Selesai Dijalankan!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tabulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span> <span class="c1"># Untuk memuat data Iris dan labelnya</span>

<span class="c1"># --- 1. Persiapan Data Iris ---</span>
<span class="c1"># Memuat dataset Iris dan menormalisasinya.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Persiapan Data ---&quot;</span><span class="p">)</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X_original</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span> <span class="c1"># Data Iris asli (fitur)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>   <span class="c1"># Label sebenarnya (ground truth)</span>
                       <span class="c1"># 0: Setosa, 1: Versicolor, 2: Virginica</span>

<span class="c1"># Normalisasi Data: Penting untuk FCM agar fitur memiliki skala yang seragam.</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_original</span><span class="p">)</span> <span class="c1"># X adalah data yang sudah dinormalisasi, akan jadi input FCM</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Iris asli (5 baris pertama):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_original</span><span class="p">[:</span><span class="mi">5</span><span class="p">]),</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Label Asli (5 data pertama):&quot;</span><span class="p">,</span> <span class="n">y_true</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Iris setelah normalisasi (5 baris pertama):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">]),</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bentuk data input (X): </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bentuk label asli (y_true): </span><span class="si">{</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># --- 2. Parameter FCM ---</span>
<span class="n">NUM_CLUSTERS</span> <span class="o">=</span> <span class="mi">3</span>       <span class="c1"># Jumlah cluster yang diinginkan (C)</span>
<span class="n">FUZZINESS_PARAM</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># Parameter fuzziness (m). m &gt; 1, umumnya 2.0.</span>

<span class="n">CONVERGENCE_TOLERANCE</span> <span class="o">=</span> <span class="mf">1e-4</span> <span class="c1"># Toleransi konvergensi (epsilon)</span>
<span class="n">MAX_ITERATIONS</span> <span class="o">=</span> <span class="mi">100</span>       <span class="c1"># Batas iterasi maksimum</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===== PARAMETER FCM =====&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah Cluster: </span><span class="si">{</span><span class="n">NUM_CLUSTERS</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter Fuzziness (m): </span><span class="si">{</span><span class="n">FUZZINESS_PARAM</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Toleransi Konvergensi: </span><span class="si">{</span><span class="n">CONVERGENCE_TOLERANCE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maksimum Iterasi: </span><span class="si">{</span><span class="n">MAX_ITERATIONS</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- 3. Fungsi-fungsi Inti Fuzzy C-Means (FCM) ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">initialize_membership_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_clusters_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Menginisialisasi matriks keanggotaan (U) secara acak.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># Untuk hasil yang konsisten</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">U_initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">,</span> <span class="n">num_clusters_val</span><span class="p">)</span>
    <span class="n">U_normalized</span> <span class="o">=</span> <span class="n">U_initial</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">U_initial</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; Matriks Keanggotaan Awal (U) diinisialisasi.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">U_normalized</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_centroids</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">U_matrix</span><span class="p">,</span> <span class="n">fuzziness_param_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Menghitung pusat setiap cluster (centroid) berdasarkan matriks keanggotaan saat ini.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">num_dimensions</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">num_clusters_val</span> <span class="o">=</span> <span class="n">U_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_clusters_val</span><span class="p">,</span> <span class="n">num_dimensions</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters_val</span><span class="p">):</span>
        <span class="n">u_ij_pow_m</span> <span class="o">=</span> <span class="n">U_matrix</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">**</span> <span class="n">fuzziness_param_val</span>
        <span class="n">numerator_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">u_ij_pow_m</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">denominator_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">u_ij_pow_m</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">denominator_sum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dimensions</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerator_sum</span> <span class="o">/</span> <span class="n">denominator_sum</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; Centroid dihitung.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centroids</span>

<span class="k">def</span><span class="w"> </span><span class="nf">update_membership_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids_matrix</span><span class="p">,</span> <span class="n">fuzziness_param_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Memperbarui matriks keanggotaan (U) berdasarkan centroid yang baru.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">num_clusters_val</span> <span class="o">=</span> <span class="n">centroids_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">U_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_data_points</span><span class="p">,</span> <span class="n">num_clusters_val</span><span class="p">))</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">fuzziness_param_val</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters_val</span><span class="p">):</span>
            <span class="n">distance_to_cj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">distance_to_cj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="k">break</span>

            <span class="n">denominator_sum_k</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters_val</span><span class="p">):</span>
                <span class="n">distance_to_ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">distance_to_ck</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">distance_to_ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>

                <span class="n">ratio_power</span> <span class="o">=</span> <span class="p">(</span><span class="n">distance_to_cj</span> <span class="o">/</span> <span class="n">distance_to_ck</span><span class="p">)</span> <span class="o">**</span> <span class="n">exponent</span>
                <span class="n">denominator_sum_k</span> <span class="o">+=</span> <span class="n">ratio_power</span>

            <span class="k">if</span> <span class="n">denominator_sum_k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">num_clusters_val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">denominator_sum_k</span>

    <span class="n">U_normalized</span> <span class="o">=</span> <span class="n">U_new</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">U_new</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; Matriks Keanggotaan (U) diperbarui.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">U_normalized</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_convergence</span><span class="p">(</span><span class="n">old_centroids</span><span class="p">,</span> <span class="n">new_centroids</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Memeriksa konvergensi algoritma dengan menghitung total perubahan</span>
<span class="sd">    antara centroid lama dan centroid baru.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_delta</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">old_centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">total_delta</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">old_centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">new_centroids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  -&gt; Perubahan centroid: </span><span class="si">{</span><span class="n">total_delta</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total_delta</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">total_delta</span>

<span class="c1"># --- 4. Alur Utama Algoritma Fuzzy C-Means ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==================== MEMULAI ALGORITMA FUZZY C-MEANS ====================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">U_current</span> <span class="o">=</span> <span class="n">initialize_membership_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">NUM_CLUSTERS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriks Keanggotaan Awal (5 baris pertama):</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">centroids_old</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">has_converged</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">last_delta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

<span class="k">while</span> <span class="n">iteration</span> <span class="o">&lt;</span> <span class="n">MAX_ITERATIONS</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_converged</span><span class="p">:</span>
    <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===== ITERASI </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> =====&quot;</span><span class="p">)</span>

    <span class="n">centroids_new</span> <span class="o">=</span> <span class="n">calculate_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U_current</span><span class="p">,</span> <span class="n">FUZZINESS_PARAM</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Centroid setelah Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">centroids_new</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">iteration</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">has_converged</span><span class="p">,</span> <span class="n">last_delta</span> <span class="o">=</span> <span class="n">check_convergence</span><span class="p">(</span><span class="n">centroids_old</span><span class="p">,</span> <span class="n">centroids_new</span><span class="p">,</span> <span class="n">CONVERGENCE_TOLERANCE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_converged</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; **KONVERGENSI TERCAPAI!** Perubahan centroid di bawah toleransi.&quot;</span><span class="p">)</span>
            <span class="k">break</span>

    <span class="n">centroids_old</span> <span class="o">=</span> <span class="n">centroids_new</span>
    <span class="n">U_current</span> <span class="o">=</span> <span class="n">update_membership_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids_new</span><span class="p">,</span> <span class="n">FUZZINESS_PARAM</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">U_current</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriks Keanggotaan (U) setelah Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> (5 baris pertama):</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriks Keanggotaan (U) setelah Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- 5. Hasil Akhir Clustering Fuzzy C-Means ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">==================== HASIL AKHIR CLUSTERING FUZZY C-MEANS ====================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah Iterasi yang Berjalan: </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Toleransi Konvergensi Epsilon: </span><span class="si">{</span><span class="n">CONVERGENCE_TOLERANCE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Perubahan Centroid Terakhir: </span><span class="si">{</span><span class="n">last_delta</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Centroid Akhir:</span><span class="se">\n</span><span class="si">{</span><span class="n">centroids_new</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matriks Keanggotaan Akhir (U) (5 baris pertama):</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Interpretasi Hasil (Hard Assignment - Opsional) ---</span>
<span class="c1"># Untuk visualisasi atau pemahaman yang lebih mudah, kita bisa &quot;mengubah&quot; hasil fuzzy</span>
<span class="c1"># menjadi penugasan cluster yang &quot;keras&quot; (hard assignment).</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Penugasan Cluster (Hard Assignment - Untuk Interpretasi) ---&quot;</span><span class="p">)</span>
<span class="n">cluster_assignment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">U_current</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Mengambil indeks kolom dengan nilai tertinggi di setiap baris</span>

<span class="c1"># Tampilkan penugasan untuk beberapa data poin</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))):</span> <span class="c1"># Tampilkan 10 data poin pertama</span>
    <span class="c1"># Menampilkan data asli dan normalisasi untuk perbandingan</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data Asli ke-</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">X_original</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">) -&gt; Normalisasi (</span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">) -&gt; Paling condong ke Cluster </span><span class="si">{</span><span class="n">cluster_assignment</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># --- 6. Menghitung Akurasi Clustering ---</span>
<span class="c1"># Ini adalah bagian baru untuk menghitung akurasi dari hasil FCM</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">==================== MENGHITUNG AKURASI CLUSTERING ====================&quot;</span><span class="p">)</span>

<span class="c1"># Langkah 1: Dapatkan hasil hard assignment (cluster yang diprediksi)</span>
<span class="c1"># `cluster_assignment` sudah kita hitung sebelumnya dari `np.argmax(U_current, axis=1)`</span>
<span class="n">predicted_clusters</span> <span class="o">=</span> <span class="n">cluster_assignment</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi Cluster (10 data pertama): </span><span class="si">{</span><span class="n">predicted_clusters</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Label Asli (10 data pertama):     </span><span class="si">{</span><span class="n">y_true</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Langkah 2: Lakukan pemetaan cluster ke label asli (ground truth)</span>
<span class="c1"># Karena clustering adalah unsupervised, cluster ID (0, 1, 2) mungkin tidak</span>
<span class="c1"># secara langsung sesuai dengan label asli (0, 1, 2). Kita perlu mencari pemetaan terbaik.</span>
<span class="c1"># Metode yang umum adalah mencari label asli yang paling sering muncul (mode)</span>
<span class="c1"># di setiap cluster yang ditemukan oleh FCM.</span>

<span class="c1"># Inisialisasi mapping dari cluster_ID (hasil FCM) ke true_label_ID (label asli)</span>
<span class="n">cluster_to_label_map</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Kita akan menyimpan daftar label asli yang jatuh ke setiap cluster yang diprediksi</span>
<span class="c1"># Misalnya: cluster_labels_collections[0] akan berisi semua label asli dari data</span>
<span class="c1">#           yang diprediksi masuk ke cluster 0 oleh FCM.</span>
<span class="n">cluster_labels_collections</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_CLUSTERS</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_clusters</span><span class="p">)):</span>
    <span class="n">cluster_id</span> <span class="o">=</span> <span class="n">predicted_clusters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Cluster yang diprediksi oleh FCM untuk data ke-i</span>
    <span class="n">true_label</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>              <span class="c1"># Label asli dari data ke-i</span>
    <span class="n">cluster_labels_collections</span><span class="p">[</span><span class="n">cluster_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">true_label</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi Label Asli dalam Setiap Cluster yang Ditemukan (untuk pemetaan):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">cluster_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_CLUSTERS</span><span class="p">):</span>
    <span class="n">labels_in_cluster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cluster_labels_collections</span><span class="p">[</span><span class="n">cluster_id</span><span class="p">])</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_in_cluster</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Cluster </span><span class="si">{</span><span class="n">cluster_id</span><span class="si">}</span><span class="s2"> (FCM): Kosong, tidak ada label asli yang dipetakan.&quot;</span><span class="p">)</span>
        <span class="n">cluster_to_label_map</span><span class="p">[</span><span class="n">cluster_id</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># Tandai sebagai tidak terpeta atau kosong</span>
        <span class="k">continue</span>

    <span class="c1"># Cari label yang paling sering muncul (mode) di antara label asli di cluster ini</span>
    <span class="c1"># np.bincount menghitung frekuensi kemunculan setiap nilai integer non-negatif</span>
    <span class="c1"># np.argmax dari bincount akan memberikan indeks nilai yang paling sering</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_in_cluster</span><span class="p">)</span>
    <span class="n">most_common_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>

    <span class="c1"># Simpan pemetaan: cluster_id (hasil FCM) -&gt; most_common_label (label asli)</span>
    <span class="n">cluster_to_label_map</span><span class="p">[</span><span class="n">cluster_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">most_common_label</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Cluster </span><span class="si">{</span><span class="n">cluster_id</span><span class="si">}</span><span class="s2"> (FCM) paling banyak berisi Label Asli: </span><span class="si">{</span><span class="n">most_common_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Jika ingin melihat distribusi detail, uncomment baris di bawah:</span>
    <span class="c1"># print(f&quot;    Detail Label Asli di Cluster {cluster_id}: {labels_in_cluster}&quot;)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mapping Akhir Cluster ID (hasil FCM) ke Label Asli:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cluster_to_label_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Cluster </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> (FCM) -&gt; Label </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> (Asli)&quot;</span><span class="p">)</span>

<span class="c1"># Langkah 3: Terapkan pemetaan dan hitung akurasi</span>
<span class="n">correct_predictions</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_clusters</span><span class="p">)):</span>
    <span class="n">predicted_cluster_id</span> <span class="o">=</span> <span class="n">predicted_clusters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># Cluster yang diprediksi oleh FCM</span>
    <span class="n">true_label</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>                      <span class="c1"># Label asli dari data ini</span>

    <span class="c1"># Dapatkan label asli yang dipetakan untuk cluster yang diprediksi ini</span>
    <span class="c1"># Gunakan .get() dengan nilai default -1 untuk cluster yang mungkin kosong</span>
    <span class="n">mapped_predicted_label</span> <span class="o">=</span> <span class="n">cluster_to_label_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">predicted_cluster_id</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mapped_predicted_label</span> <span class="o">==</span> <span class="n">true_label</span><span class="p">:</span>
        <span class="n">correct_predictions</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">total_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">correct_predictions</span> <span class="o">/</span> <span class="n">total_data_points</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total Data Poin: </span><span class="si">{</span><span class="n">total_data_points</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi Benar: </span><span class="si">{</span><span class="n">correct_predictions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi Clustering: </span><span class="si">{</span><span class="n">accuracy</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Ringkasan Penugasan Cluster (Mapping dengan Label Asli) ---&quot;</span><span class="p">)</span>
<span class="c1"># Tampilkan penugasan untuk beberapa data poin pertama untuk ringkasan visual</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))):</span> <span class="c1"># Menampilkan 20 data poin pertama</span>
    <span class="n">pred_cluster_id</span> <span class="o">=</span> <span class="n">predicted_clusters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">mapped_label</span> <span class="o">=</span> <span class="n">cluster_to_label_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pred_cluster_id</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">true_label</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;BENAR&#39;</span> <span class="k">if</span> <span class="n">mapped_label</span> <span class="o">==</span> <span class="n">true_label</span> <span class="k">else</span> <span class="s1">&#39;SALAH&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data ke-</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: Prediksi Cluster=</span><span class="si">{</span><span class="n">pred_cluster_id</span><span class="si">}</span><span class="s2">, Mapped Label=</span><span class="si">{</span><span class="n">mapped_label</span><span class="si">}</span><span class="s2">, Label Asli=</span><span class="si">{</span><span class="n">true_label</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">FCM dan Evaluasi Akurasi Selesai!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Persiapan Data ---
Data Iris asli (5 baris pertama):
 +----+-----+-----+-----+-----+
|    |   0 |   1 |   2 |   3 |
|----+-----+-----+-----+-----|
|  0 | 5.1 | 3.5 | 1.4 | 0.2 |
|  1 | 4.9 | 3   | 1.4 | 0.2 |
|  2 | 4.7 | 3.2 | 1.3 | 0.2 |
|  3 | 4.6 | 3.1 | 1.5 | 0.2 |
|  4 | 5   | 3.6 | 1.4 | 0.2 |
+----+-----+-----+-----+-----+

Label Asli (5 data pertama): [0 0 0 0 0]

Data Iris setelah normalisasi (5 baris pertama):
 +----+-----------+------------+----------+----------+
|    |         0 |          1 |        2 |        3 |
|----+-----------+------------+----------+----------|
|  0 | -0.900681 |  1.019     | -1.34023 | -1.31544 |
|  1 | -1.14302  | -0.131979  | -1.34023 | -1.31544 |
|  2 | -1.38535  |  0.328414  | -1.39706 | -1.31544 |
|  3 | -1.50652  |  0.0982173 | -1.28339 | -1.31544 |
|  4 | -1.02185  |  1.2492    | -1.34023 | -1.31544 |
+----+-----------+------------+----------+----------+

Bentuk data input (X): (150, 4)

Bentuk label asli (y_true): (150,)

===== PARAMETER FCM =====
Jumlah Cluster: 3
Parameter Fuzziness (m): 2.0
Toleransi Konvergensi: 0.0001
Maksimum Iterasi: 100

==================== MEMULAI ALGORITMA FUZZY C-MEANS ====================

  -&gt; Matriks Keanggotaan Awal (U) diinisialisasi.
Matriks Keanggotaan Awal (5 baris pertama):
[[0.18205878 0.46212909 0.35581214]
 [0.65738127 0.17132261 0.17129612]
 [0.03807826 0.56784481 0.39407693]
 [0.41686469 0.01211874 0.57101657]
 [0.67865488 0.173111   0.14823412]]


===== ITERASI 1 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 1:
[[ 0.18015492 -0.07895799  0.14860201  0.15783118]
 [ 0.04673142 -0.00414338  0.05866575  0.04549694]
 [-0.21994478  0.10763652 -0.23597937 -0.23185324]]

  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 1 (5 baris pertama):
[[0.2494674  0.29314748 0.45738512]
 [0.2480877  0.29068336 0.46122895]
 [0.25021306 0.29279211 0.45699483]
 [0.25153709 0.29380514 0.45465777]
 [0.25542594 0.29749592 0.44707814]]


===== ITERASI 2 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 2:
[[ 0.32184306 -0.1805122   0.37013276  0.35227467]
 [ 0.09168238 -0.07223049  0.13191807  0.12638803]
 [-0.53229799  0.3315663  -0.64475067 -0.61969803]]

  -&gt; Perubahan centroid: 1.16078266
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 2 (5 baris pertama):
[[0.12775305 0.17188507 0.70036187]
 [0.13495836 0.18358899 0.68145265]
 [0.13423824 0.18029596 0.6854658 ]
 [0.14174222 0.19003133 0.66822644]
 [0.14318196 0.1891916  0.66762645]]


===== ITERASI 3 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 3:
[[ 0.54842153 -0.29010549  0.62566069  0.60271587]
 [ 0.19164575 -0.28365576  0.33878461  0.31553709]
 [-0.91807092  0.66119838 -1.14719383 -1.10547294]]

  -&gt; Perubahan centroid: 1.66616314
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 3 (5 baris pertama):
[[0.01769137 0.02400847 0.95830016]
 [0.06197241 0.08874478 0.84928282]
 [0.03367654 0.04692638 0.91939709]
 [0.05399274 0.07589992 0.87010734]
 [0.03267689 0.04348979 0.92383332]]


===== ITERASI 4 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 4:
[[ 0.75729236 -0.27163118  0.79720003  0.80449727]
 [ 0.18693994 -0.48490762  0.42456647  0.36461684]
 [-1.00775384  0.78085939 -1.26824864 -1.22369912]]

  -&gt; Perubahan centroid: 0.78787712
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 4 (5 baris pertama):
[[0.00597923 0.00858945 0.98543133]
 [0.05782805 0.09374129 0.84843067]
 [0.02448582 0.0376478  0.93786639]
 [0.04536425 0.07140931 0.88322644]
 [0.01543982 0.02157635 0.96298383]]


===== ITERASI 5 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 5:
[[ 0.91520067 -0.1385193   0.89030625  0.92401051]
 [ 0.09740256 -0.618484    0.38934005  0.30687318]
 [-1.01118785  0.81254576 -1.27890281 -1.2338868 ]]

  -&gt; Perubahan centroid: 0.46570825
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 5 (5 baris pertama):
[[0.00441004 0.00693579 0.98865417]
 [0.05438303 0.10457231 0.84104467]
 [0.02344094 0.04141778 0.93514128]
 [0.04276529 0.07864364 0.87859107]
 [0.01243955 0.01880568 0.96875477]]


===== ITERASI 6 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 6:
[[ 1.01131803 -0.03539321  0.94138468  0.99238841]
 [ 0.02395985 -0.71827716  0.35425733  0.26436111]
 [-1.00968312  0.82685112 -1.28231656 -1.23684492]]

  -&gt; Perubahan centroid: 0.31548582
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 6 (5 baris pertama):
[[0.00377473 0.00624999 0.98997528]
 [0.0521259  0.11189493 0.83597917]
 [0.02288477 0.04413232 0.93298291]
 [0.04123853 0.08378506 0.87497641]
 [0.01119343 0.01767655 0.97113001]]


===== ITERASI 7 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 7:
[[ 1.05271844  0.01260556  0.96254383  1.02035291]
 [-0.01134712 -0.77287087  0.33699174  0.24620761]
 [-1.008006    0.83600557 -1.28397448 -1.23824254]]

  -&gt; Perubahan centroid: 0.15167211
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 7 (5 baris pertama):
[[0.00344072 0.00579579 0.99076349]
 [0.05148125 0.11567397 0.83284478]
 [0.02285623 0.04564498 0.93149879]
 [0.04086653 0.08649856 0.87263492]
 [0.0105537  0.01689913 0.97254717]]


===== ITERASI 8 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 8:
[[ 1.06666802  0.03023271  0.96951309  1.02913695]
 [-0.02570045 -0.7978924   0.32986435  0.23919126]
 [-1.00658186  0.84120516 -1.28446324 -1.23859456]]

  -&gt; Perubahan centroid: 0.06107579
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 8 (5 baris pertama):
[[0.00327713 0.00554156 0.99118131]
 [0.05146351 0.11743897 0.83109752]
 [0.02299524 0.04643945 0.93056531]
 [0.04092608 0.08781551 0.8712584 ]
 [0.01025287 0.01646119 0.97328594]]


===== ITERASI 9 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 9:
[[ 1.07040342  0.03598237  0.97122495  1.03119672]
 [-0.03174789 -0.80881614  0.32677023  0.23613266]
 [-1.00572028  0.84383716 -1.28458578 -1.23864684]]

  -&gt; Perubahan centroid: 0.02335594
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 9 (5 baris pertama):
[[0.00320192 0.00541609 0.99138199]
 [0.05156944 0.11826932 0.83016124]
 [0.02311806 0.04684149 0.93004045]
 [0.04104647 0.08845229 0.87050123]
 [0.01012023 0.0162466  0.97363317]]


===== ITERASI 10 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 10:
[[ 1.07092767  0.037628    0.97133109  1.03128832]
 [-0.03460262 -0.8136931   0.32523109  0.23456073]
 [-1.00527289  0.84511521 -1.28462194 -1.23864862]]

  -&gt; Perubahan centroid: 0.00915154
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 10 (5 baris pertama):
[[0.00316791 0.0053568  0.99147529]
 [0.05166315 0.11868036 0.82965649]
 [0.02319667 0.04704525 0.92975808]
 [0.04113793 0.08877091 0.87009116]
 [0.01006267 0.01614645 0.97379088]]


===== ITERASI 11 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 11:
[[ 1.07062836  0.03795517  0.97106733  1.03094055]
 [-0.03611224 -0.81599922  0.32436799  0.23365369]
 [-1.00504871  0.84574215 -1.28463625 -1.23864642]]

  -&gt; Perubahan centroid: 0.00431553
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 11 (5 baris pertama):
[[0.0031522  0.00532857 0.99151922]
 [0.05172661 0.11889729 0.8293761 ]
 [0.02324298 0.04715219 0.92960483]
 [0.04119638 0.0889391  0.86986452]
 [0.0100372  0.01609953 0.97386327]]


===== ITERASI 12 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 12:
[[ 1.07022689  0.03790588  0.97079145  1.03058539]
 [-0.03697796 -0.81716827  0.32384861  0.23309874]
 [-1.00493374  0.84606261 -1.28464336 -1.23864543]]

  -&gt; Perubahan centroid: 0.00258670
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 12 (5 baris pertama):
[[0.0031446  0.00531458 0.99154082]
 [0.05176664 0.11901885 0.8292145 ]
 [0.02327    0.04721114 0.92951886]
 [0.04123215 0.08903297 0.86973488]
 [0.01002537 0.01607672 0.97389791]]


===== ITERASI 13 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 13:
[[ 1.06990223  0.0377821   0.97058144  1.03031556]
 [-0.03749886 -0.81780109  0.32352557  0.23275087]
 [-1.00487194  0.8462354  -1.28464735 -1.23864524]]

  -&gt; Perubahan centroid: 0.00161822
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 13 (5 baris pertama):
[[0.00314067 0.00530726 0.99155207]
 [0.05179148 0.11909021 0.8291183 ]
 [0.02328601 0.04724516 0.92946883]
 [0.04125396 0.08908783 0.86965821]
 [0.0100195  0.016065   0.9739155 ]]


===== ITERASI 14 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 14:
[[ 1.06967341  0.03767015  0.97043711  1.03012972]
 [-0.03782038 -0.8181622   0.32332197  0.23253094]
 [-1.00483702  0.84633341 -1.28464972 -1.23864534]]

  -&gt; Perubahan centroid: 0.00101971
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 14 (5 baris pertama):
[[0.00313852 0.00530321 0.99155827]
 [0.0518069  0.11913345 0.82905965]
 [0.02329567 0.04726551 0.92943881]
 [0.04126737 0.08912095 0.86961168]
 [0.01001637 0.01605862 0.97392501]]


===== ITERASI 15 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 15:
[[ 1.06952092  0.03758706  0.97034212  1.03000708]
 [-0.03802139 -0.8183762   0.32319308  0.23239156]
 [-1.00481649  0.84639125 -1.28465117 -1.23864549]]

  -&gt; Perubahan centroid: 0.00064389
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 15 (5 baris pertama):
[[0.00313728 0.00530086 0.99156187]
 [0.05181652 0.11916015 0.82902333]
 [0.02330161 0.04727797 0.92942042]
 [0.04127568 0.08914136 0.86958296]
 [0.01001461 0.01605496 0.97393042]]


===== ITERASI 16 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 16:
[[ 1.06942191  0.03753002  0.97028086  1.02992778]
 [-0.03814783 -0.81850624  0.3231114   0.23230324]
 [-1.00480405  0.84642634 -1.28465207 -1.23864561]]

  -&gt; Perubahan centroid: 0.00040686
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 16 (5 baris pertama):
[[0.00313653 0.00529945 0.99156402]
 [0.05182254 0.11917682 0.82900064]
 [0.02330529 0.04728571 0.929409  ]
 [0.04128087 0.08915409 0.86956505]
 [0.01001357 0.0160528  0.97393363]]


===== ITERASI 17 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 17:
[[ 1.06935845  0.0374923   0.97024174  1.02987705]
 [-0.03822759 -0.81858652  0.32305965  0.23224729]
 [-1.00479639  0.846448   -1.28465263 -1.2386457 ]]

  -&gt; Perubahan centroid: 0.00025716
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 17 (5 baris pertama):
[[0.00313608 0.00529858 0.99156534]
 [0.05182633 0.1191873  0.82898637]
 [0.0233076  0.04729056 0.92940185]
 [0.04128412 0.08916207 0.8695538 ]
 [0.01001294 0.01605147 0.97393559]]


===== ITERASI 18 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 18:
[[ 1.06931805  0.03746785  0.97021689  1.02984478]
 [-0.03827797 -0.81863657  0.32302689  0.23221187]
 [-1.00479161  0.84646151 -1.28465298 -1.23864576]]

  -&gt; Perubahan centroid: 0.00016255
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 18 (5 baris pertama):
[[0.00313579 0.00529805 0.99156616]
 [0.05182872 0.1191939  0.82897739]
 [0.02330904 0.04729361 0.92939735]
 [0.04128617 0.08916711 0.86954672]
 [0.01001255 0.01605066 0.9739368 ]]


===== ITERASI 19 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 19:
[[ 1.06929241  0.03745216  0.97020113  1.0298243 ]
 [-0.03830981 -0.81866794  0.32300615  0.23218945]
 [-1.00478862  0.84646999 -1.2846532  -1.2386458 ]]

  -&gt; Perubahan centroid: 0.00010276
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 19 (5 baris pertama):
[[0.00313562 0.00529771 0.99156667]
 [0.05183022 0.11919806 0.82897171]
 [0.02330996 0.04729553 0.92939452]
 [0.04128747 0.08917028 0.86954225]
 [0.0100123  0.01605015 0.97393755]]


===== ITERASI 20 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 20:
[[ 1.06927618  0.03744217  0.97019116  1.02981133]
 [-0.03832994 -0.81868768  0.32299303  0.23217528]
 [-1.00478673  0.84647532 -1.28465334 -1.23864583]]

  -&gt; Perubahan centroid: 0.00006496

&gt;&gt;&gt; **KONVERGENSI TERCAPAI!** Perubahan centroid di bawah toleransi.

==================== HASIL AKHIR CLUSTERING FUZZY C-MEANS ====================
Jumlah Iterasi yang Berjalan: 20
Toleransi Konvergensi Epsilon: 0.0001
Perubahan Centroid Terakhir: 0.00006496

Centroid Akhir:
[[ 1.06927618  0.03744217  0.97019116  1.02981133]
 [-0.03832994 -0.81868768  0.32299303  0.23217528]
 [-1.00478673  0.84647532 -1.28465334 -1.23864583]]

Matriks Keanggotaan Akhir (U) (5 baris pertama):
[[0.00313562 0.00529771 0.99156667]
 [0.05183022 0.11919806 0.82897171]
 [0.02330996 0.04729553 0.92939452]
 [0.04128747 0.08917028 0.86954225]
 [0.0100123  0.01605015 0.97393755]]

--- Penugasan Cluster (Hard Assignment - Untuk Interpretasi) ---
Data Asli ke-1 ([5.1 3.5 1.4 0.2]) -&gt; Normalisasi ([-0.9   1.02 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-2 ([4.9 3.  1.4 0.2]) -&gt; Normalisasi ([-1.14 -0.13 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-3 ([4.7 3.2 1.3 0.2]) -&gt; Normalisasi ([-1.39  0.33 -1.4  -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-4 ([4.6 3.1 1.5 0.2]) -&gt; Normalisasi ([-1.51  0.1  -1.28 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-5 ([5.  3.6 1.4 0.2]) -&gt; Normalisasi ([-1.02  1.25 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-6 ([5.4 3.9 1.7 0.4]) -&gt; Normalisasi ([-0.54  1.94 -1.17 -1.05]) -&gt; Paling condong ke Cluster 3
Data Asli ke-7 ([4.6 3.4 1.4 0.3]) -&gt; Normalisasi ([-1.51  0.79 -1.34 -1.18]) -&gt; Paling condong ke Cluster 3
Data Asli ke-8 ([5.  3.4 1.5 0.2]) -&gt; Normalisasi ([-1.02  0.79 -1.28 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-9 ([4.4 2.9 1.4 0.2]) -&gt; Normalisasi ([-1.75 -0.36 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-10 ([4.9 3.1 1.5 0.1]) -&gt; Normalisasi ([-1.14  0.1  -1.28 -1.45]) -&gt; Paling condong ke Cluster 3

==================== MENGHITUNG AKURASI CLUSTERING ====================
Prediksi Cluster (10 data pertama): [2 2 2 2 2 2 2 2 2 2]
Label Asli (10 data pertama):     [0 0 0 0 0 0 0 0 0 0]

Distribusi Label Asli dalam Setiap Cluster yang Ditemukan (untuk pemetaan):
  Cluster 0 (FCM) paling banyak berisi Label Asli: 2
  Cluster 1 (FCM) paling banyak berisi Label Asli: 1
  Cluster 2 (FCM) paling banyak berisi Label Asli: 0

Mapping Akhir Cluster ID (hasil FCM) ke Label Asli:
  Cluster 0 (FCM) -&gt; Label 2 (Asli)
  Cluster 1 (FCM) -&gt; Label 1 (Asli)
  Cluster 2 (FCM) -&gt; Label 0 (Asli)

Total Data Poin: 150
Prediksi Benar: 126
Akurasi Clustering: 84.00%

--- Ringkasan Penugasan Cluster (Mapping dengan Label Asli) ---
Data ke-1: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-2: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-3: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-4: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-5: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-6: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-7: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-8: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-9: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-10: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-11: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-12: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-13: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-14: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-15: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-16: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-17: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-18: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-19: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]
Data ke-20: Prediksi Cluster=2, Mapped Label=0, Label Asli=0 [BENAR]

FCM dan Evaluasi Akurasi Selesai!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tabulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span> <span class="c1"># Untuk memuat data Iris dan labelnya</span>

<span class="c1"># --- 1. Persiapan Data Iris ---</span>
<span class="c1"># Memuat dataset Iris dan menormalisasinya.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Persiapan Data ---&quot;</span><span class="p">)</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X_original</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span> <span class="c1"># Data Iris asli (fitur)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>   <span class="c1"># Label sebenarnya (ground truth)</span>
                       <span class="c1"># 0: Setosa, 1: Versicolor, 2: Virginica</span>

<span class="c1"># Normalisasi Data: Penting untuk FCM agar fitur memiliki skala yang seragam.</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_original</span><span class="p">)</span> <span class="c1"># X adalah data yang sudah dinormalisasi, akan jadi input FCM</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Iris asli (5 baris pertama):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_original</span><span class="p">[:</span><span class="mi">5</span><span class="p">]),</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Label Asli (5 data pertama):&quot;</span><span class="p">,</span> <span class="n">y_true</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Iris setelah normalisasi (5 baris pertama):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">]),</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bentuk data input (X): </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bentuk label asli (y_true): </span><span class="si">{</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># --- 2. Parameter FCM ---</span>
<span class="n">NUM_CLUSTERS</span> <span class="o">=</span> <span class="mi">3</span>       <span class="c1"># Jumlah cluster yang diinginkan (C)</span>
<span class="n">FUZZINESS_PARAM</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># Parameter fuzziness (m). m &gt; 1, umumnya 2.0.</span>

<span class="n">CONVERGENCE_TOLERANCE</span> <span class="o">=</span> <span class="mf">1e-4</span> <span class="c1"># Toleransi konvergensi (epsilon)</span>
<span class="n">MAX_ITERATIONS</span> <span class="o">=</span> <span class="mi">100</span>       <span class="c1"># Batas iterasi maksimum</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===== PARAMETER FCM =====&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah Cluster: </span><span class="si">{</span><span class="n">NUM_CLUSTERS</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter Fuzziness (m): </span><span class="si">{</span><span class="n">FUZZINESS_PARAM</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Toleransi Konvergensi: </span><span class="si">{</span><span class="n">CONVERGENCE_TOLERANCE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maksimum Iterasi: </span><span class="si">{</span><span class="n">MAX_ITERATIONS</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- 3. Fungsi-fungsi Inti Fuzzy C-Means (FCM) ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">initialize_membership_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_clusters_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Menginisialisasi matriks keanggotaan (U) secara acak.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># Untuk hasil yang konsisten</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">U_initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">,</span> <span class="n">num_clusters_val</span><span class="p">)</span>
    <span class="n">U_normalized</span> <span class="o">=</span> <span class="n">U_initial</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">U_initial</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; Matriks Keanggotaan Awal (U) diinisialisasi.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">U_normalized</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_centroids</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">U_matrix</span><span class="p">,</span> <span class="n">fuzziness_param_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Menghitung pusat setiap cluster (centroid) berdasarkan matriks keanggotaan saat ini.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">num_dimensions</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">num_clusters_val</span> <span class="o">=</span> <span class="n">U_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_clusters_val</span><span class="p">,</span> <span class="n">num_dimensions</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters_val</span><span class="p">):</span>
        <span class="n">u_ij_pow_m</span> <span class="o">=</span> <span class="n">U_matrix</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">**</span> <span class="n">fuzziness_param_val</span>
        <span class="n">numerator_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">u_ij_pow_m</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">denominator_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">u_ij_pow_m</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">denominator_sum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dimensions</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerator_sum</span> <span class="o">/</span> <span class="n">denominator_sum</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; Centroid dihitung.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centroids</span>

<span class="k">def</span><span class="w"> </span><span class="nf">update_membership_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids_matrix</span><span class="p">,</span> <span class="n">fuzziness_param_val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Memperbarui matriks keanggotaan (U) berdasarkan centroid yang baru.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">num_clusters_val</span> <span class="o">=</span> <span class="n">centroids_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">U_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_data_points</span><span class="p">,</span> <span class="n">num_clusters_val</span><span class="p">))</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">fuzziness_param_val</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters_val</span><span class="p">):</span>
            <span class="n">distance_to_cj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">distance_to_cj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="k">break</span>

            <span class="n">denominator_sum_k</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_clusters_val</span><span class="p">):</span>
                <span class="n">distance_to_ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">distance_to_ck</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">distance_to_ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>

                <span class="n">ratio_power</span> <span class="o">=</span> <span class="p">(</span><span class="n">distance_to_cj</span> <span class="o">/</span> <span class="n">distance_to_ck</span><span class="p">)</span> <span class="o">**</span> <span class="n">exponent</span>
                <span class="n">denominator_sum_k</span> <span class="o">+=</span> <span class="n">ratio_power</span>

            <span class="k">if</span> <span class="n">denominator_sum_k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">num_clusters_val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">denominator_sum_k</span>

    <span class="n">U_normalized</span> <span class="o">=</span> <span class="n">U_new</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">U_new</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  -&gt; Matriks Keanggotaan (U) diperbarui.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">U_normalized</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_convergence</span><span class="p">(</span><span class="n">old_centroids</span><span class="p">,</span> <span class="n">new_centroids</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Memeriksa konvergensi algoritma dengan menghitung total perubahan</span>
<span class="sd">    antara centroid lama dan centroid baru.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_delta</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">old_centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">total_delta</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">old_centroids</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">new_centroids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  -&gt; Perubahan centroid: </span><span class="si">{</span><span class="n">total_delta</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total_delta</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">total_delta</span>

<span class="c1"># --- 4. Alur Utama Algoritma Fuzzy C-Means ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==================== MEMULAI ALGORITMA FUZZY C-MEANS ====================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">U_current</span> <span class="o">=</span> <span class="n">initialize_membership_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">NUM_CLUSTERS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriks Keanggotaan Awal (5 baris pertama):</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">centroids_old</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">has_converged</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">last_delta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

<span class="k">while</span> <span class="n">iteration</span> <span class="o">&lt;</span> <span class="n">MAX_ITERATIONS</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_converged</span><span class="p">:</span>
    <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===== ITERASI </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> =====&quot;</span><span class="p">)</span>

    <span class="n">centroids_new</span> <span class="o">=</span> <span class="n">calculate_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">U_current</span><span class="p">,</span> <span class="n">FUZZINESS_PARAM</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Centroid setelah Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">centroids_new</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">iteration</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">has_converged</span><span class="p">,</span> <span class="n">last_delta</span> <span class="o">=</span> <span class="n">check_convergence</span><span class="p">(</span><span class="n">centroids_old</span><span class="p">,</span> <span class="n">centroids_new</span><span class="p">,</span> <span class="n">CONVERGENCE_TOLERANCE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_converged</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&gt;&gt;&gt; **KONVERGENSI TERCAPAI!** Perubahan centroid di bawah toleransi.&quot;</span><span class="p">)</span>
            <span class="k">break</span>

    <span class="n">centroids_old</span> <span class="o">=</span> <span class="n">centroids_new</span>
    <span class="n">U_current</span> <span class="o">=</span> <span class="n">update_membership_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids_new</span><span class="p">,</span> <span class="n">FUZZINESS_PARAM</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">U_current</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriks Keanggotaan (U) setelah Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> (5 baris pertama):</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matriks Keanggotaan (U) setelah Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- 5. Hasil Akhir Clustering Fuzzy C-Means ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">==================== HASIL AKHIR CLUSTERING FUZZY C-MEANS ====================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah Iterasi yang Berjalan: </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Toleransi Konvergensi Epsilon: </span><span class="si">{</span><span class="n">CONVERGENCE_TOLERANCE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Perubahan Centroid Terakhir: </span><span class="si">{</span><span class="n">last_delta</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Centroid Akhir:</span><span class="se">\n</span><span class="si">{</span><span class="n">centroids_new</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matriks Keanggotaan Akhir (U) (5 baris pertama):</span><span class="se">\n</span><span class="si">{</span><span class="n">U_current</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Interpretasi Hasil (Hard Assignment - Opsional) ---</span>
<span class="c1"># Untuk visualisasi atau pemahaman yang lebih mudah, kita bisa &quot;mengubah&quot; hasil fuzzy</span>
<span class="c1"># menjadi penugasan cluster yang &quot;keras&quot; (hard assignment).</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Penugasan Cluster (Hard Assignment - Untuk Interpretasi) ---&quot;</span><span class="p">)</span>
<span class="n">cluster_assignment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">U_current</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Mengambil indeks kolom dengan nilai tertinggi di setiap baris</span>

<span class="c1"># Tampilkan penugasan untuk beberapa data poin</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))):</span> <span class="c1"># Tampilkan 10 data poin pertama</span>
    <span class="c1"># Menampilkan data asli dan normalisasi untuk perbandingan</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data Asli ke-</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">X_original</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">) -&gt; Normalisasi (</span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">) -&gt; Paling condong ke Cluster </span><span class="si">{</span><span class="n">cluster_assignment</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># --- 6. Menghitung Akurasi Clustering (OUTPUT SESUAI PERMINTAAN) ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">==================== MENGHITUNG AKURASI CLUSTERING ====================&quot;</span><span class="p">)</span>

<span class="c1"># Langkah 1: Dapatkan hasil hard assignment (cluster yang diprediksi)</span>
<span class="n">predicted_clusters</span> <span class="o">=</span> <span class="n">cluster_assignment</span>

<span class="c1"># Langkah 2: Lakukan pemetaan cluster ke label asli (ground truth)</span>
<span class="n">cluster_to_label_map</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">cluster_labels_collections</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_CLUSTERS</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_clusters</span><span class="p">)):</span>
    <span class="n">cluster_id</span> <span class="o">=</span> <span class="n">predicted_clusters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">true_label</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">cluster_labels_collections</span><span class="p">[</span><span class="n">cluster_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">true_label</span><span class="p">)</span>

<span class="k">for</span> <span class="n">cluster_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_CLUSTERS</span><span class="p">):</span>
    <span class="n">labels_in_cluster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cluster_labels_collections</span><span class="p">[</span><span class="n">cluster_id</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_in_cluster</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cluster_to_label_map</span><span class="p">[</span><span class="n">cluster_id</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">continue</span>

    <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_in_cluster</span><span class="p">)</span>
    <span class="n">most_common_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="n">cluster_to_label_map</span><span class="p">[</span><span class="n">cluster_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">most_common_label</span>

<span class="c1"># Langkah 3: Terapkan pemetaan dan hitung akurasi</span>
<span class="n">correct_predictions</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predicted_clusters</span><span class="p">)):</span>
    <span class="n">predicted_cluster_id</span> <span class="o">=</span> <span class="n">predicted_clusters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">true_label</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">mapped_predicted_label</span> <span class="o">=</span> <span class="n">cluster_to_label_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">predicted_cluster_id</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mapped_predicted_label</span> <span class="o">==</span> <span class="n">true_label</span><span class="p">:</span>
        <span class="n">correct_predictions</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">total_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">correct_predictions</span> <span class="o">/</span> <span class="n">total_data_points</span>

<span class="c1"># --- Output Akurasi Sesuai Format yang Diminta ---</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Data Poin: </span><span class="si">{</span><span class="n">total_data_points</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi Benar: </span><span class="si">{</span><span class="n">correct_predictions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi Clustering: </span><span class="si">{</span><span class="n">accuracy</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">FCM dan Evaluasi Akurasi Selesai!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Persiapan Data ---
Data Iris asli (5 baris pertama):
 +----+-----+-----+-----+-----+
|    |   0 |   1 |   2 |   3 |
|----+-----+-----+-----+-----|
|  0 | 5.1 | 3.5 | 1.4 | 0.2 |
|  1 | 4.9 | 3   | 1.4 | 0.2 |
|  2 | 4.7 | 3.2 | 1.3 | 0.2 |
|  3 | 4.6 | 3.1 | 1.5 | 0.2 |
|  4 | 5   | 3.6 | 1.4 | 0.2 |
+----+-----+-----+-----+-----+

Label Asli (5 data pertama): [0 0 0 0 0]

Data Iris setelah normalisasi (5 baris pertama):
 +----+-----------+------------+----------+----------+
|    |         0 |          1 |        2 |        3 |
|----+-----------+------------+----------+----------|
|  0 | -0.900681 |  1.019     | -1.34023 | -1.31544 |
|  1 | -1.14302  | -0.131979  | -1.34023 | -1.31544 |
|  2 | -1.38535  |  0.328414  | -1.39706 | -1.31544 |
|  3 | -1.50652  |  0.0982173 | -1.28339 | -1.31544 |
|  4 | -1.02185  |  1.2492    | -1.34023 | -1.31544 |
+----+-----------+------------+----------+----------+

Bentuk data input (X): (150, 4)

Bentuk label asli (y_true): (150,)

===== PARAMETER FCM =====
Jumlah Cluster: 3
Parameter Fuzziness (m): 2.0
Toleransi Konvergensi: 0.0001
Maksimum Iterasi: 100

==================== MEMULAI ALGORITMA FUZZY C-MEANS ====================

  -&gt; Matriks Keanggotaan Awal (U) diinisialisasi.
Matriks Keanggotaan Awal (5 baris pertama):
[[0.18205878 0.46212909 0.35581214]
 [0.65738127 0.17132261 0.17129612]
 [0.03807826 0.56784481 0.39407693]
 [0.41686469 0.01211874 0.57101657]
 [0.67865488 0.173111   0.14823412]]


===== ITERASI 1 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 1:
[[ 0.18015492 -0.07895799  0.14860201  0.15783118]
 [ 0.04673142 -0.00414338  0.05866575  0.04549694]
 [-0.21994478  0.10763652 -0.23597937 -0.23185324]]

  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 1 (5 baris pertama):
[[0.2494674  0.29314748 0.45738512]
 [0.2480877  0.29068336 0.46122895]
 [0.25021306 0.29279211 0.45699483]
 [0.25153709 0.29380514 0.45465777]
 [0.25542594 0.29749592 0.44707814]]


===== ITERASI 2 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 2:
[[ 0.32184306 -0.1805122   0.37013276  0.35227467]
 [ 0.09168238 -0.07223049  0.13191807  0.12638803]
 [-0.53229799  0.3315663  -0.64475067 -0.61969803]]

  -&gt; Perubahan centroid: 1.16078266
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 2 (5 baris pertama):
[[0.12775305 0.17188507 0.70036187]
 [0.13495836 0.18358899 0.68145265]
 [0.13423824 0.18029596 0.6854658 ]
 [0.14174222 0.19003133 0.66822644]
 [0.14318196 0.1891916  0.66762645]]


===== ITERASI 3 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 3:
[[ 0.54842153 -0.29010549  0.62566069  0.60271587]
 [ 0.19164575 -0.28365576  0.33878461  0.31553709]
 [-0.91807092  0.66119838 -1.14719383 -1.10547294]]

  -&gt; Perubahan centroid: 1.66616314
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 3 (5 baris pertama):
[[0.01769137 0.02400847 0.95830016]
 [0.06197241 0.08874478 0.84928282]
 [0.03367654 0.04692638 0.91939709]
 [0.05399274 0.07589992 0.87010734]
 [0.03267689 0.04348979 0.92383332]]


===== ITERASI 4 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 4:
[[ 0.75729236 -0.27163118  0.79720003  0.80449727]
 [ 0.18693994 -0.48490762  0.42456647  0.36461684]
 [-1.00775384  0.78085939 -1.26824864 -1.22369912]]

  -&gt; Perubahan centroid: 0.78787712
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 4 (5 baris pertama):
[[0.00597923 0.00858945 0.98543133]
 [0.05782805 0.09374129 0.84843067]
 [0.02448582 0.0376478  0.93786639]
 [0.04536425 0.07140931 0.88322644]
 [0.01543982 0.02157635 0.96298383]]


===== ITERASI 5 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 5:
[[ 0.91520067 -0.1385193   0.89030625  0.92401051]
 [ 0.09740256 -0.618484    0.38934005  0.30687318]
 [-1.01118785  0.81254576 -1.27890281 -1.2338868 ]]

  -&gt; Perubahan centroid: 0.46570825
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 5 (5 baris pertama):
[[0.00441004 0.00693579 0.98865417]
 [0.05438303 0.10457231 0.84104467]
 [0.02344094 0.04141778 0.93514128]
 [0.04276529 0.07864364 0.87859107]
 [0.01243955 0.01880568 0.96875477]]


===== ITERASI 6 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 6:
[[ 1.01131803 -0.03539321  0.94138468  0.99238841]
 [ 0.02395985 -0.71827716  0.35425733  0.26436111]
 [-1.00968312  0.82685112 -1.28231656 -1.23684492]]

  -&gt; Perubahan centroid: 0.31548582
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 6 (5 baris pertama):
[[0.00377473 0.00624999 0.98997528]
 [0.0521259  0.11189493 0.83597917]
 [0.02288477 0.04413232 0.93298291]
 [0.04123853 0.08378506 0.87497641]
 [0.01119343 0.01767655 0.97113001]]


===== ITERASI 7 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 7:
[[ 1.05271844  0.01260556  0.96254383  1.02035291]
 [-0.01134712 -0.77287087  0.33699174  0.24620761]
 [-1.008006    0.83600557 -1.28397448 -1.23824254]]

  -&gt; Perubahan centroid: 0.15167211
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 7 (5 baris pertama):
[[0.00344072 0.00579579 0.99076349]
 [0.05148125 0.11567397 0.83284478]
 [0.02285623 0.04564498 0.93149879]
 [0.04086653 0.08649856 0.87263492]
 [0.0105537  0.01689913 0.97254717]]


===== ITERASI 8 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 8:
[[ 1.06666802  0.03023271  0.96951309  1.02913695]
 [-0.02570045 -0.7978924   0.32986435  0.23919126]
 [-1.00658186  0.84120516 -1.28446324 -1.23859456]]

  -&gt; Perubahan centroid: 0.06107579
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 8 (5 baris pertama):
[[0.00327713 0.00554156 0.99118131]
 [0.05146351 0.11743897 0.83109752]
 [0.02299524 0.04643945 0.93056531]
 [0.04092608 0.08781551 0.8712584 ]
 [0.01025287 0.01646119 0.97328594]]


===== ITERASI 9 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 9:
[[ 1.07040342  0.03598237  0.97122495  1.03119672]
 [-0.03174789 -0.80881614  0.32677023  0.23613266]
 [-1.00572028  0.84383716 -1.28458578 -1.23864684]]

  -&gt; Perubahan centroid: 0.02335594
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 9 (5 baris pertama):
[[0.00320192 0.00541609 0.99138199]
 [0.05156944 0.11826932 0.83016124]
 [0.02311806 0.04684149 0.93004045]
 [0.04104647 0.08845229 0.87050123]
 [0.01012023 0.0162466  0.97363317]]


===== ITERASI 10 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 10:
[[ 1.07092767  0.037628    0.97133109  1.03128832]
 [-0.03460262 -0.8136931   0.32523109  0.23456073]
 [-1.00527289  0.84511521 -1.28462194 -1.23864862]]

  -&gt; Perubahan centroid: 0.00915154
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 10 (5 baris pertama):
[[0.00316791 0.0053568  0.99147529]
 [0.05166315 0.11868036 0.82965649]
 [0.02319667 0.04704525 0.92975808]
 [0.04113793 0.08877091 0.87009116]
 [0.01006267 0.01614645 0.97379088]]


===== ITERASI 11 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 11:
[[ 1.07062836  0.03795517  0.97106733  1.03094055]
 [-0.03611224 -0.81599922  0.32436799  0.23365369]
 [-1.00504871  0.84574215 -1.28463625 -1.23864642]]

  -&gt; Perubahan centroid: 0.00431553
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 11 (5 baris pertama):
[[0.0031522  0.00532857 0.99151922]
 [0.05172661 0.11889729 0.8293761 ]
 [0.02324298 0.04715219 0.92960483]
 [0.04119638 0.0889391  0.86986452]
 [0.0100372  0.01609953 0.97386327]]


===== ITERASI 12 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 12:
[[ 1.07022689  0.03790588  0.97079145  1.03058539]
 [-0.03697796 -0.81716827  0.32384861  0.23309874]
 [-1.00493374  0.84606261 -1.28464336 -1.23864543]]

  -&gt; Perubahan centroid: 0.00258670
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 12 (5 baris pertama):
[[0.0031446  0.00531458 0.99154082]
 [0.05176664 0.11901885 0.8292145 ]
 [0.02327    0.04721114 0.92951886]
 [0.04123215 0.08903297 0.86973488]
 [0.01002537 0.01607672 0.97389791]]


===== ITERASI 13 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 13:
[[ 1.06990223  0.0377821   0.97058144  1.03031556]
 [-0.03749886 -0.81780109  0.32352557  0.23275087]
 [-1.00487194  0.8462354  -1.28464735 -1.23864524]]

  -&gt; Perubahan centroid: 0.00161822
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 13 (5 baris pertama):
[[0.00314067 0.00530726 0.99155207]
 [0.05179148 0.11909021 0.8291183 ]
 [0.02328601 0.04724516 0.92946883]
 [0.04125396 0.08908783 0.86965821]
 [0.0100195  0.016065   0.9739155 ]]


===== ITERASI 14 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 14:
[[ 1.06967341  0.03767015  0.97043711  1.03012972]
 [-0.03782038 -0.8181622   0.32332197  0.23253094]
 [-1.00483702  0.84633341 -1.28464972 -1.23864534]]

  -&gt; Perubahan centroid: 0.00101971
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 14 (5 baris pertama):
[[0.00313852 0.00530321 0.99155827]
 [0.0518069  0.11913345 0.82905965]
 [0.02329567 0.04726551 0.92943881]
 [0.04126737 0.08912095 0.86961168]
 [0.01001637 0.01605862 0.97392501]]


===== ITERASI 15 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 15:
[[ 1.06952092  0.03758706  0.97034212  1.03000708]
 [-0.03802139 -0.8183762   0.32319308  0.23239156]
 [-1.00481649  0.84639125 -1.28465117 -1.23864549]]

  -&gt; Perubahan centroid: 0.00064389
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 15 (5 baris pertama):
[[0.00313728 0.00530086 0.99156187]
 [0.05181652 0.11916015 0.82902333]
 [0.02330161 0.04727797 0.92942042]
 [0.04127568 0.08914136 0.86958296]
 [0.01001461 0.01605496 0.97393042]]


===== ITERASI 16 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 16:
[[ 1.06942191  0.03753002  0.97028086  1.02992778]
 [-0.03814783 -0.81850624  0.3231114   0.23230324]
 [-1.00480405  0.84642634 -1.28465207 -1.23864561]]

  -&gt; Perubahan centroid: 0.00040686
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 16 (5 baris pertama):
[[0.00313653 0.00529945 0.99156402]
 [0.05182254 0.11917682 0.82900064]
 [0.02330529 0.04728571 0.929409  ]
 [0.04128087 0.08915409 0.86956505]
 [0.01001357 0.0160528  0.97393363]]


===== ITERASI 17 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 17:
[[ 1.06935845  0.0374923   0.97024174  1.02987705]
 [-0.03822759 -0.81858652  0.32305965  0.23224729]
 [-1.00479639  0.846448   -1.28465263 -1.2386457 ]]

  -&gt; Perubahan centroid: 0.00025716
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 17 (5 baris pertama):
[[0.00313608 0.00529858 0.99156534]
 [0.05182633 0.1191873  0.82898637]
 [0.0233076  0.04729056 0.92940185]
 [0.04128412 0.08916207 0.8695538 ]
 [0.01001294 0.01605147 0.97393559]]


===== ITERASI 18 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 18:
[[ 1.06931805  0.03746785  0.97021689  1.02984478]
 [-0.03827797 -0.81863657  0.32302689  0.23221187]
 [-1.00479161  0.84646151 -1.28465298 -1.23864576]]

  -&gt; Perubahan centroid: 0.00016255
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 18 (5 baris pertama):
[[0.00313579 0.00529805 0.99156616]
 [0.05182872 0.1191939  0.82897739]
 [0.02330904 0.04729361 0.92939735]
 [0.04128617 0.08916711 0.86954672]
 [0.01001255 0.01605066 0.9739368 ]]


===== ITERASI 19 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 19:
[[ 1.06929241  0.03745216  0.97020113  1.0298243 ]
 [-0.03830981 -0.81866794  0.32300615  0.23218945]
 [-1.00478862  0.84646999 -1.2846532  -1.2386458 ]]

  -&gt; Perubahan centroid: 0.00010276
  -&gt; Matriks Keanggotaan (U) diperbarui.
Matriks Keanggotaan (U) setelah Iterasi 19 (5 baris pertama):
[[0.00313562 0.00529771 0.99156667]
 [0.05183022 0.11919806 0.82897171]
 [0.02330996 0.04729553 0.92939452]
 [0.04128747 0.08917028 0.86954225]
 [0.0100123  0.01605015 0.97393755]]


===== ITERASI 20 =====
  -&gt; Centroid dihitung.

Centroid setelah Iterasi 20:
[[ 1.06927618  0.03744217  0.97019116  1.02981133]
 [-0.03832994 -0.81868768  0.32299303  0.23217528]
 [-1.00478673  0.84647532 -1.28465334 -1.23864583]]

  -&gt; Perubahan centroid: 0.00006496

&gt;&gt;&gt; **KONVERGENSI TERCAPAI!** Perubahan centroid di bawah toleransi.

==================== HASIL AKHIR CLUSTERING FUZZY C-MEANS ====================
Jumlah Iterasi yang Berjalan: 20
Toleransi Konvergensi Epsilon: 0.0001
Perubahan Centroid Terakhir: 0.00006496

Centroid Akhir:
[[ 1.06927618  0.03744217  0.97019116  1.02981133]
 [-0.03832994 -0.81868768  0.32299303  0.23217528]
 [-1.00478673  0.84647532 -1.28465334 -1.23864583]]

Matriks Keanggotaan Akhir (U) (5 baris pertama):
[[0.00313562 0.00529771 0.99156667]
 [0.05183022 0.11919806 0.82897171]
 [0.02330996 0.04729553 0.92939452]
 [0.04128747 0.08917028 0.86954225]
 [0.0100123  0.01605015 0.97393755]]

--- Penugasan Cluster (Hard Assignment - Untuk Interpretasi) ---
Data Asli ke-1 ([5.1 3.5 1.4 0.2]) -&gt; Normalisasi ([-0.9   1.02 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-2 ([4.9 3.  1.4 0.2]) -&gt; Normalisasi ([-1.14 -0.13 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-3 ([4.7 3.2 1.3 0.2]) -&gt; Normalisasi ([-1.39  0.33 -1.4  -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-4 ([4.6 3.1 1.5 0.2]) -&gt; Normalisasi ([-1.51  0.1  -1.28 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-5 ([5.  3.6 1.4 0.2]) -&gt; Normalisasi ([-1.02  1.25 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-6 ([5.4 3.9 1.7 0.4]) -&gt; Normalisasi ([-0.54  1.94 -1.17 -1.05]) -&gt; Paling condong ke Cluster 3
Data Asli ke-7 ([4.6 3.4 1.4 0.3]) -&gt; Normalisasi ([-1.51  0.79 -1.34 -1.18]) -&gt; Paling condong ke Cluster 3
Data Asli ke-8 ([5.  3.4 1.5 0.2]) -&gt; Normalisasi ([-1.02  0.79 -1.28 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-9 ([4.4 2.9 1.4 0.2]) -&gt; Normalisasi ([-1.75 -0.36 -1.34 -1.32]) -&gt; Paling condong ke Cluster 3
Data Asli ke-10 ([4.9 3.1 1.5 0.1]) -&gt; Normalisasi ([-1.14  0.1  -1.28 -1.45]) -&gt; Paling condong ke Cluster 3

==================== MENGHITUNG AKURASI CLUSTERING ====================
Total Data Poin: 150
Prediksi Benar: 126
Akurasi Clustering: 84.00%

FCM dan Evaluasi Akurasi Selesai!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">silhouette_score</span><span class="p">,</span> <span class="n">silhouette_samples</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.cm</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cm</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">==================== SILHOUETTE SCORE DAN VISUALISASI ====================&quot;</span><span class="p">)</span>

<span class="c1"># 1. Hitung Silhouette Score dari hasil hard assignment</span>
<span class="n">sil_score</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">predicted_clusters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silhouette Score (rata-rata): </span><span class="si">{</span><span class="n">sil_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 2. Hitung semua nilai silhouette untuk masing-masing sample</span>
<span class="n">sample_silhouette_values</span> <span class="o">=</span> <span class="n">silhouette_samples</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">predicted_clusters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==================== SILHOUETTE SCORE DAN VISUALISASI ====================
Silhouette Score (rata-rata): 0.4584
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="n">MYSQL_HOST</span> <span class="o">=</span> <span class="s2">&quot;mysql-ce646e0-matakuliah.i.aivencloud.com&quot;</span>
<span class="n">MYSQL_PORT</span> <span class="o">=</span> <span class="mi">18376</span>
<span class="n">MYSQL_DB</span> <span class="o">=</span> <span class="s2">&quot;defaultdb&quot;</span>
<span class="n">MYSQL_USER</span> <span class="o">=</span> <span class="s2">&quot;avnadmin&quot;</span>
<span class="n">MYSQL_PASS</span> <span class="o">=</span> <span class="s2">&quot;AVNS_ttJDVCcji3xAatQ6zvd&quot;</span>

<span class="c1"># Buat koneksi dengan SQLAlchemy</span>
<span class="c1"># Berikan parameter ssl sebagai dictionary untuk PyMySQL</span>
<span class="n">db_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;mysql+pymysql://</span><span class="si">{</span><span class="n">MYSQL_USER</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">MYSQL_PASS</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">MYSQL_HOST</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">MYSQL_PORT</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">MYSQL_DB</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># Tambahkan connect_args untuk parameter SSL</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">db_url</span><span class="p">,</span> <span class="n">connect_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ssl&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ssl&#39;</span><span class="p">:</span> <span class="p">{}}})</span>


<span class="c1"># Ambil data</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT sepalLengthCm, sepalWidthCm, petalLengthCm, petalWidthCm FROM irissql;&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>

<span class="c1"># Visualisasi</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;sepalLengthCm&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;sepalWidthCm&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sepal Length vs Width&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sepal Length (cm)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Sepal Width (cm)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;petalLengthCm&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;petalWidthCm&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Petal Length vs Width&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Petal Length (cm)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Petal Width (cm)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de7c7164a6b9acab9221c1b43b08bbacce750bd97cc5af7000ac6a94e3c1a5b9.png" src="_images/de7c7164a6b9acab9221c1b43b08bbacce750bd97cc5af7000ac6a94e3c1a5b9.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">FUZZY C MEANS</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pengertian-fuzzy-c-means">Pengertian Fuzzy C Means</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#konsep-kunci">Konsep Kunci</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cara-kerja">Cara Kerja</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-penting-fuzziness">Parameter Penting: Fuzziness</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-algoritma">Langkah Algoritma</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Muhammad Abid Ayyasy
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>